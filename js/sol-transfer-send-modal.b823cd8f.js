"use strict";(self["webpackChunksuperhero_wallet"]=self["webpackChunksuperhero_wallet"]||[]).push([[8116],{34620(e,t,n){n.d(t,{x:()=>h});var a=n(95383),r=n(31252),o=n(70068),s=(n(53921),n(27495),n(25440),n(42762),n(98992),n(72577),n(3949),n(81454),n(62953),n(3296),n(27208),n(48408),n(76918),n(28706),n(50113),n(51629),n(62062),n(15086),n(23288),n(62010),n(18111),n(20116),n(7588),n(61701),n(79432),n(26099),n(38781),n(47764),n(23500),n(14603),n(47566),n(98721),n(50953)),l=n(20641),i=n(73834),u=n(81268),c=n(75220),d=n(22483),v=n(18743),f=n(96881),m=n(84560),p=n(53611),A=n(69264),b=n(96605),g=function(e,t,n,a){function r(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{i(a.next(e))}catch(t){o(t)}}function l(e){try{i(a["throw"](e))}catch(t){o(t)}}function i(e){e.done?n(e.value):r(e.value).then(s,l)}i((a=a.apply(e,t||[])).next())})};function h(e){var t=e.transferData,n=e.getSelectedAssetValue,h=(0,s.KR)(t),y=(0,s.KR)(null),S=(0,s.KR)(null),w=(0,c.lq)(),k=(0,c.rd)(),x=(0,i.s9)(),C=x.t,T=(0,d.U8)(),O=T.openDefaultModal,I=T.openScanQrModal,E=(0,u.mN)(),F=E.errors,_=E.validate,B=E.validateField,M=(0,A.t)(),R=M.saveTransferSendFormModel,N=(0,b.S)(),D=N.accountAssets,L=(0,d.oV)(),P=L.activeAccount,W=(0,l.EW)(function(){return["addresses","amount"].some(function(e){return"error"===(0,f.sY)(F.value[e]).status})});function $(){h.value.payload=""}function V(e){h.value.selectedAsset=e}function X(e,t){var n,a=e.account,r=e.amount,s=e.payload,l=e.token,i={},u=t?t(l,h.value.selectedAsset):null;return u&&(i.selectedAsset=u),a&&(i.addresses=[a].concat((0,o.A)(null!==(n=h.value.addresses)&&void 0!==n?n:[]))),r&&(i.amount=r),s&&(i.payload=s),i}function j(e){return g(this,void 0,void 0,(0,r.A)().m(function t(){var a;return(0,r.A)().w(function(t){while(1)switch(t.n){case 0:return a=X(e,n),h.value=Object.assign(Object.assign({},h.value),a),t.n=1,(0,l.dY)();case 1:Object.keys(a).forEach(function(e){return B(e)});case 2:return t.a(2)}},t)}))}function q(){var e,t;return g(this,void 0,void 0,(0,r.A)().m(function n(){var s,l,i,u;return(0,r.A)().w(function(n){while(1)switch(n.p=n.n){case 0:return n.n=1,I({title:C("pages.send.scanAddress",{assetName:null===(e=h.value.selectedAsset)||void 0===e?void 0:e.name})}).then(function(e){return e})["catch"](function(e){return e instanceof p.yr&&R(h.value),null});case 1:if(s=n.v,"{"!==(null===s||void 0===s?void 0:s.trim().charAt(0))){n.n=7;break}l=null,n.p=2,l=JSON.parse(s),n.n=4;break;case 3:return n.p=3,u=n.v,v.p8||m.A.write(u),h.value.addresses=void 0,O({title:C("modals.invalid-qr-code.msg"),icon:"critical"}),n.a(2);case 4:if(i=D.value.find(function(e){var t=e.contractId;return t===l.tokenContract}),i){n.n=5;break}return h.value.addresses=void 0,O({msg:C("modals.insufficient-balance.msg")}),n.a(2);case 5:return h.value.selectedAsset=i,h.value.addresses=[l.tokenContract],h.value.amount=(0,f.Y9)(l.amount,-((null===(t=h.value.selectedAsset)||void 0===t?void 0:t.decimals)||-0)).toString(),y.value=l.invoiceId,S.value=l.invoiceContract,n.n=6,_();case 6:n.n=9;break;case 7:if(s){n.n=8;break}return n.a(2);case 8:j(Object.fromEntries((0,o.A)(new URL((0,f.Ks)(s)?s:"".concat(v.yS,"/account?account=").concat(s.replace("?","&"))).searchParams.entries()).map(function(e){var t=(0,a.A)(e,2),n=t[0],r=t[1];return[n,r]}))),y.value=null;case 9:h.value.addresses||(h.value.addresses=void 0);case 10:return n.a(2)}},n,null,[[2,3]])}))}return(0,l.sV)(function(){(0,l.wB)([P,function(){return w.query}],function(){var e,t=w.query;t&&Object.keys(t).length>0&&(h.value.addresses=void 0,k.replace({query:{}})),j(Object.assign(Object.assign({},t),{token:t.token||(null===(e=h.value.selectedAsset)||void 0===e?void 0:e.contractId)}))},{deep:!0,immediate:!0})}),{formModel:h,errors:F,hasError:W,invoiceId:y,invoiceContract:S,scanTransferQrCode:q,clearPayload:$,handleAssetChange:V,validate:_,updateFormModelValues:j}}},22915(e,t,n){n.d(t,{A:()=>b});var a=n(20641),r=n(90033),o={class:"address-container"};function s(e,t,n,s,l,i){var u=(0,a.g2)("Avatar"),c=(0,a.g2)("AddressFormatted");return(0,a.uX)(),(0,a.CE)("div",{class:(0,r.C4)(["avatar-with-chain-name",{"only-name":!e.showAddress&&!e.hideAvatar}]),style:(0,r.Tr)({"background-color":e.color})},[e.hideAvatar?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(u,(0,a.v6)({key:0},e.$attrs,{size:e.avatarSize,address:e.localChainNameAddress||e.address}),null,16,["size","address"])),(0,a.Lk)("div",o,[e.calculatedName?((0,a.uX)(),(0,a.CE)("div",{key:0,class:(0,r.C4)(["address-name",{centered:e.hideAvatar}])},(0,r.v_)(e.calculatedName),3)):(0,a.Q3)("",!0),e.showAddress?((0,a.uX)(),(0,a.Wv)(c,(0,a.v6)({key:1},e.$attrs,{address:e.localChainNameAddress||e.address,class:"text-address",columns:""}),null,16,["address"])):(0,a.Q3)("",!0)])],6)}n(98992),n(54520),n(37550),n(2008),n(15086),n(62010),n(18111),n(22489),n(13579),n(26099);var l=n(96881),i=n(22483),u=n(46578),c=n(59579),d=n(64224),v=n(93271),f=n(15059);const m=(0,a.pM)({components:{AddressFormatted:f.A,Avatar:v.A},props:{address:{type:String,required:!0},name:{type:String,default:""},hideAvatar:Boolean,avatarSize:{type:String,default:"md"},protocol:{type:String,required:!0}},setup:function(e){var t=(0,i.oV)(),n=t.accountsGroupedByProtocol,r=(0,i.Gf)(),o=r.allAccounts,s=(0,c.q)(),v=s.ownedNames,f=(0,i.ci)(),m=f.multisigAccounts;function p(t){var a;return(null===(a=n.value[e.protocol])||void 0===a?void 0:a.some(function(e){return e.address===t}))||m.value.some(function(e){return e.gaAccountId===t})}var A=(0,a.EW)(function(){return o.value.filter(function(t){return t.address===e.address})[0]}),b=(0,a.EW)(function(){var t=v.value.filter(function(t){return t.name===e.name&&t.pointers.accountPubkey})[0];return t?t.pointers.accountPubkey:""}),g=(0,a.EW)(function(){var t;return e.name||b.value||(null===(t=A.value)||void 0===t?void 0:t.name)||(0,u.tg)("modals.send.recipientLabel")}),h=(0,a.EW)(function(){return!(0,d.Eo)(e.address)||b.value}),y=(0,a.EW)(function(){return e.address&&!(0,d.Eo)(e.address)&&p(e.address)||b.value?(0,l.cr)(b.value||e.address):void 0});return{showAddress:h,localChainNameAddress:b,calculatedName:g,color:y}}});var p=n(66262);const A=(0,p.A)(m,[["render",s],["__scopeId","data-v-4979f97a"]]),b=A},49476(e,t,n){n.d(t,{A:()=>g,g:()=>m});var a=n(20641),r=n(53751),o={class:"relative"};function s(e,t,n,s,l,i){var u=(0,a.g2)("BtnMain"),c=(0,a.g2)("Modal");return(0,a.uX)(),(0,a.Wv)(c,{class:"transfer-send-base","has-close-button":"","from-bottom":"","no-padding-bottom":e.currentStep===e.TRANSFER_SEND_STEPS.form,onClose:t[2]||(t[2]=function(t){return e.$emit("close")})},{footer:(0,a.k6)(function(){return[e.showEditButton?((0,a.uX)(),(0,a.Wv)(u,{key:0,variant:"muted",text:e.$t("common.edit"),class:"button-action-secondary","data-cy":"edit",onClick:t[0]||(t[0]=function(t){return e.$emit("step-prev")})},null,8,["text"])):(0,a.Q3)("",!0),(0,a.bF)(u,{class:"button-action-primary",disabled:!e.isOnline||e.sendingDisabled,icon:e.primaryButtonIcon,text:e.primaryButtonText,"data-cy":"next-step-button",onClick:t[1]||(t[1]=function(t){return e.$emit("step-next")})},null,8,["disabled","icon","text"])]}),default:(0,a.k6)(function(){return[(0,a.Lk)("div",o,[(0,a.bF)(r.eB,{name:"fade-between"},{default:(0,a.k6)(function(){return[(0,a.RG)(e.$slots,"content",{},void 0,!0)]}),_:3})])]}),_:3},8,["no-padding-bottom"])}n(74423);var l=n(73834),i=n(18743),u=n(22483),c=n(53908),d=n(5402),v=n(61341),f=n(55312),m={resolve:{type:Function,default:function(){return null}},address:{type:String,default:void 0},amount:{type:String,default:""},payload:{type:String,default:""},protocol:{type:String,required:!0}};const p=(0,a.pM)({name:"TransferSendBase",components:{Modal:v.A,BtnMain:f.A},props:{customPrimaryButtonText:{type:String,default:""},currentStep:{type:String,required:!0},sendingDisabled:Boolean,hideArrowSendIcon:Boolean},emits:["close","step-prev","step-next"],setup:function(e){var t=(0,l.s9)(),n=t.t,r=(0,u.w5)(),o=r.isOnline,s=(0,u.oV)(),v=s.isActiveAccountAirGap,f=(0,a.EW)(function(){return[i.x0.review,i.x0.reviewTip,i.x0.airGapSign].includes(e.currentStep)}),m=(0,a.EW)(function(){return[i.x0.review,i.x0.airGapSign].includes(e.currentStep)}),p=(0,a.EW)(function(){return e.currentStep===i.x0.review&&v.value}),A=(0,a.EW)(function(){return e.customPrimaryButtonText?e.customPrimaryButtonText:m.value?n("common.send"):n("common.next")}),b=(0,a.EW)(function(){return!m.value||p.value||e.hideArrowSendIcon?null:c.A});return{isOnline:o,primaryButtonText:A,primaryButtonIcon:b,showEditButton:f,showSendButton:m,ArrowSendIcon:c.A,QrScanIcon:d.A,TRANSFER_SEND_STEPS:i.x0}}});var A=n(66262);const b=(0,A.A)(p,[["render",s],["__scopeId","data-v-23eea20d"]]),g=b},52036(e,t,n){n.d(t,{A:()=>w});n(28706);var a=n(20641),r=n(90033),o={class:"transfer-review-base"},s={key:0},l={key:0};function i(e,t,n,i,u,c){var d,v,f,m,p,A=(0,a.g2)("ModalHeader"),b=(0,a.g2)("AvatarWithChainName"),g=(0,a.g2)("DetailsItem"),h=(0,a.g2)("TokenAmount"),y=(0,a.g2)("PayloadDetails"),S=(0,a.g2)("Loader");return(0,a.uX)(),(0,a.CE)("div",o,[(0,a.bF)(A,{title:e.title,subtitle:e.withoutSubtitle?null:e.subtitle,"no-padding":e.noHeaderPadding},{title:(0,a.k6)(function(){return[e.$slots.title?((0,a.uX)(),(0,a.CE)("div",s,[(0,a.RG)(e.$slots,"title",{},void 0,!0)])):(0,a.Q3)("",!0)]}),_:3},8,["title","subtitle","no-padding"]),(0,a.RG)(e.$slots,"subheader",{},void 0,!0),(0,a.bF)(g,{label:e.senderLabel,class:"sending-address","data-cy":"review-sender"},{value:(0,a.k6)(function(){return[(0,a.bF)(b,{address:e.activeAccount.address,protocol:e.protocol},null,8,["address","protocol"])]}),_:1},8,["label"]),e.$slots.recipient?((0,a.uX)(),(0,a.CE)("div",l,[(0,a.RG)(e.$slots,"recipient",{},void 0,!0)])):((0,a.uX)(),(0,a.Wv)(g,{key:1,class:(0,r.C4)(["details-item receiving-addresses",{"multiple-addresses":(null===(d=e.transferData.addresses)||void 0===d?void 0:d.length)>1}]),"data-cy":"review-recipient",expandable:(null===(v=e.transferData.addresses)||void 0===v?void 0:v.length)>1,label:"".concat(e.$t("pages.send.show")," ").concat(null===(f=e.transferData.addresses)||void 0===f?void 0:f.length," ").concat(e.$t("pages.send.recipients")),"expanded-label":(null===(m=e.transferData.addresses)||void 0===m?void 0:m.length)>1?"".concat(e.$t("pages.send.hide")," ").concat(null===(p=e.transferData.addresses)||void 0===p?void 0:p.length," ").concat(e.$t("pages.send.recipients")):e.$t("pages.send.recipient")},{value:(0,a.k6)(function(){return[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.transferData.addresses,function(t){return(0,a.uX)(),(0,a.CE)("div",{key:t,class:"receiving-address"},[(0,a.bF)(b,{address:t,name:e.isNameValid(t)?t:void 0,protocol:e.protocol},null,8,["address","name","protocol"])])}),128))]}),_:1},8,["class","expandable","label","expanded-label"])),(0,a.bF)(g,{label:e.amountLabel,class:"details-item"},{value:(0,a.k6)(function(){var t;return[(0,a.bF)(h,{amount:+e.transferData.amount,symbol:e.tokenSymbol,protocol:e.protocol,"hide-fiat":!e.showFiat,price:null===(t=e.transferData.selectedAsset)||void 0===t?void 0:t.price,"data-cy":"review-amount"},null,8,["amount","symbol","protocol","hide-fiat","price"])]}),_:1},8,["label"]),e.recipientsCount>1?((0,a.uX)(),(0,a.Wv)(g,{key:2,label:e.multipleAmountLabel,class:"details-item"},{value:(0,a.k6)(function(){var t;return[(0,a.bF)(h,{amount:e.multipleAmount,symbol:e.tokenSymbol,protocol:e.protocol,"hide-fiat":!e.showFiat,price:null===(t=e.transferData.selectedAsset)||void 0===t?void 0:t.price,"data-cy":"review-amount"},null,8,["amount","symbol","protocol","hide-fiat","price"])]}),_:1},8,["label"])):(0,a.Q3)("",!0),(0,a.RG)(e.$slots,"additional-fee",{},void 0,!0),(0,a.bF)(g,{class:"details-item",label:e.feeLabel},{value:(0,a.k6)(function(){return[(0,a.bF)(h,{amount:+e.transferData.fee,symbol:e.baseTokenSymbol,protocol:e.protocol,"high-precision":"","data-cy":"review-fee"},null,8,["amount","symbol","protocol"])]}),_:1},8,["label"]),(0,a.RG)(e.$slots,"total",{},void 0,!0),(0,a.bF)(y,{class:"details-item","data-cy":"review-payload",payload:e.transferData.payload},null,8,["payload"]),e.loading?((0,a.uX)(),(0,a.Wv)(S,{key:3})):(0,a.Q3)("",!0)])}var u=n(64224),c=n(22483),d=n(95891),v=n(46578),f=n(90863),m=n(18494),p=n(24977),A=n(22915),b=n(40919),g=n(60447);const h=(0,a.pM)({name:"TransferReviewBase",components:{PayloadDetails:g.A,ModalHeader:b.A,AvatarWithChainName:A.A,DetailsItem:m.A,Loader:f.A,TokenAmount:p.A},props:{title:{type:String,default:(0,v.tg)("pages.send.reviewtx")},subtitle:{type:String,default:(0,v.tg)("pages.send.checkalert")},senderLabel:{type:String,default:(0,v.tg)("pages.send.sender")},amountLabel:{type:String,default:(0,v.tg)("common.amount")},multipleAmountLabel:{type:String,default:(0,v.tg)("pages.send.multipleAccountLabel")},feeLabel:{type:String,default:(0,v.tg)("transaction.fee")},baseTokenSymbol:{type:String,required:!0},transferData:{type:Object,required:!0},protocol:{type:String,required:!0},recipientAddress:{type:String,default:null},noHeaderPadding:Boolean,withoutSubtitle:Boolean,loading:Boolean,showFiat:Boolean},setup:function(e){var t=(0,c.oV)(),n=t.activeAccount,r=(0,a.EW)(function(){return e.recipientAddress&&(0,u.Eo)(e.recipientAddress)}),o=(0,a.EW)(function(){var t;return(null===(t=e.transferData.selectedAsset)||void 0===t?void 0:t.symbol)||"-"}),s=(0,a.EW)(function(){var t;return(null===(t=e.transferData.addresses)||void 0===t?void 0:t.length)||1}),l=(0,a.EW)(function(){return s.value>1&&e.transferData.amount?+e.transferData.amount*s.value:0});return{AE_CONTRACT_ID:d.cK,isRecipientName:r,tokenSymbol:o,activeAccount:n,recipientsCount:s,multipleAmount:l,isNameValid:u.Eo}}});var y=n(66262);const S=(0,y.A)(h,[["render",i],["__scopeId","data-v-433a39e4"]]),w=S},62559(e,t,n){n.d(t,{A:()=>x});var a=n(20641),r={class:"transfer-send-recipient"},o={class:"buttons"},s={key:0,class:"status"};function l(e,t,n,l,i,u){var c=(0,a.g2)("BtnIcon"),d=(0,a.g2)("FormAccountInput"),v=(0,a.g2)("UrlStatus");return(0,a.uX)(),(0,a.CE)("div",r,[(0,a.bF)(d,{"v-model":e.modelValue,"model-value":e.modelValue,name:"addresses","data-cy":"address","show-help":"","show-message-help":"","is-recipient":"","single-default-format":1===e.maxRecipients,"is-tip-url-enabled":e.isUrlTippingEnabled,protocol:e.protocol,label:e.$t("modals.send.recipientLabel"),placeholder:e.placeholder,message:e.addressMessage,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.$emit("update:modelValue",t)}),onHelp:t[3]||(t[3]=function(t){return e.showRecipientHelp()}),onBlur:t[4]||(t[4]=function(t){return e.handleBlur(t,!0)})},{"label-after":(0,a.k6)(function(){return[(0,a.Lk)("div",o,[(0,a.bF)(c,{icon:e.AddressBookIcon,"data-cy":"address-book-button",onClick:t[0]||(t[0]=function(t){return e.selectFromAddressBook()})},null,8,["icon"]),(0,a.bF)(c,{icon:e.QrScanIcon,"data-cy":"scan-button",onClick:t[1]||(t[1]=function(t){return e.$emit("openQrModal")})},null,8,["icon"])])]}),_:1},8,["v-model","model-value","single-default-format","is-tip-url-enabled","protocol","label","placeholder","message"]),e.isTipUrl?((0,a.uX)(),(0,a.CE)("div",s,[(0,a.bF)(v,{status:e.urlStatus},null,8,["status"])])):(0,a.Q3)("",!0)])}var i=n(31252),u=n(70068),c=(n(16280),n(76918),n(2892),n(26099),n(81268)),d=n(96881),v=n(18743),f=n(22483),m=n(76329),p=n(15462),A=n(96065),b=n(5402),g=n(13039),h=n(18711),y=function(e,t,n,a){function r(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{i(a.next(e))}catch(t){o(t)}}function l(e){try{i(a["throw"](e))}catch(t){o(t)}}function i(e){e.done?n(e.value):r(e.value).then(s,l)}i((a=a.apply(e,t||[])).next())})};const S=(0,a.pM)({components:{FormAccountInput:h.A,UrlStatus:p.A,BtnIcon:A.A},props:{isUrlTippingEnabled:Boolean,isTipUrl:Boolean,maxRecipients:{type:Number,default:null},modelValue:{type:Array,default:function(){return[]}},placeholder:{type:String,default:""},protocol:{type:String,required:!0},validationRules:{type:Object,default:function(){return{}}},errors:{type:Object,required:!0}},emits:["openQrModal","update:modelValue"],setup:function(e,t){var n=t.emit,r=(0,a.EW)(function(){return e.protocol===v.yv.aeternity}),o=(0,f.U8)(),s=o.openModal,l=(0,f.oV)(),p=l.activeAccount,A=(0,c.Mt)("addresses",Object.assign(Object.assign(Object.assign({required:!0},e.maxRecipients?{max_recipients:e.maxRecipients}:{}),e.validationRules),{address_not_same_as:[p.value.address,e.protocol]}),{bails:!1}),h=A.value,S=A.handleBlur,w=(0,m.NC)({ensureFetchedOnInit:r.value}),k=w.getTippingUrlStatus,x=(0,a.EW)(function(){var t;return k(null===(t=e.modelValue)||void 0===t?void 0:t[0])}),C=(0,a.EW)(function(){var t=(0,d.sY)(e.errors.addresses);if("error"===t.status)return t;if(e.isTipUrl)switch(x.value){case"verified":return{status:"success",text:"",hideMessage:!0};case"not-secure":case"not-verified":return{status:"warning",text:"",hideMessage:!0};case"blacklisted":return{status:"error",text:"",hideMessage:!0};default:throw new Error("Unknown url status: ".concat(x.value))}return t});function T(){s(v.R$,{protocol:e.protocol})}function O(){return y(this,void 0,void 0,(0,i.A)().m(function t(){var a;return(0,i.A)().w(function(t){while(1)switch(t.n){case 0:return t.n=1,s(v.tA,{preSelectedAddresses:e.modelValue,allowMultiple:e.maxRecipients>1});case 1:a=t.v,a&&n("update:modelValue",(0,u.A)(a));case 2:return t.a(2)}},t)}))}return(0,a.wB)(function(){return e.modelValue},function(e){h.value=e},{immediate:!!e.modelValue.length}),{QrScanIcon:b.A,AddressBookIcon:g.A,urlStatus:x,activeAccount:p,addressMessage:C,handleBlur:S,showRecipientHelp:T,selectFromAddressBook:O}}});var w=n(66262);const k=(0,w.A)(S,[["render",l],["__scopeId","data-v-7aa56c82"]]),x=k},10483(e,t,n){n.d(t,{A:()=>p});n(62010);var a=n(20641),r={class:"transfer-send-base"},o={class:"account-row"};function s(e,t,n,s,l,i){var u=(0,a.g2)("ModalHeader"),c=(0,a.g2)("AccountItem"),d=(0,a.g2)("TokenAmount"),v=(0,a.g2)("DetailsItem");return(0,a.uX)(),(0,a.CE)("div",r,[e.$slots.header?(0,a.RG)(e.$slots,"header",{key:0},void 0,!0):((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.bF)(u,{title:e.customTitle||e.$t("modals.send.sendTitle")},null,8,["title"]),(0,a.Lk)("div",o,[(0,a.bF)(c,{address:e.activeAccount.address,protocol:e.activeAccount.protocol,name:e.activeAccount.name,size:"md"},null,8,["address","protocol","name"])])],64)),(0,a.RG)(e.$slots,"recipient",{},void 0,!0),(0,a.RG)(e.$slots,"amount",{},void 0,!0),(0,a.RG)(e.$slots,"extra",{},void 0,!0),(0,a.bF)(v,{label:e.maxFee?e.$t("transaction.estimatedFee"):e.$t("transaction.fee")},{value:(0,a.k6)(function(){return[(0,a.bF)(d,{amount:e.fee,symbol:e.feeSymbol,protocol:e.protocol,"blink-on-change":"","data-cy":"review-fee"},null,8,["amount","symbol","protocol"])]}),_:1},8,["label"]),e.maxFee?((0,a.uX)(),(0,a.Wv)(v,{key:2,label:e.$t("transaction.maxFee")},{value:(0,a.k6)(function(){return[(0,a.bF)(d,{amount:e.maxFee,symbol:e.feeSymbol,protocol:e.protocol,"blink-on-change":"","data-cy":"review-max-fee"},null,8,["amount","symbol","protocol"])]}),_:1},8,["label"])):(0,a.Q3)("",!0)])}n(2892);var l=n(22483),i=n(18494),u=n(24977),c=n(40919),d=n(33521);const v=(0,a.pM)({name:"TransferSendFormBase",components:{ModalHeader:c.A,AccountItem:d.A,DetailsItem:i.A,TokenAmount:u.A},props:{fee:{type:Number,default:0},maxFee:{type:Number,default:void 0},feeSymbol:{type:String,required:!0},customTitle:{type:String,default:""},protocol:{type:String,required:!0}},setup:function(){var e=(0,l.oV)(),t=e.activeAccount;return{activeAccount:t}}});var f=n(66262);const m=(0,f.A)(v,[["render",s],["__scopeId","data-v-cdc4500e"]]),p=m},2915(e,t,n){n.d(t,{A:()=>c});var a=n(20641),r=n(90033);function o(e,t,n,o,s,l){var i=(0,a.g2)("BtnPlain");return(0,a.uX)(),(0,a.Wv)(i,{class:(0,r.C4)(["max-button",{chosen:e.isMax}]),text:e.$t("common.max"),onClick:t[0]||(t[0]=function(t){return e.$emit("click")})},null,8,["class","text"])}var s=n(77389);const l=(0,a.pM)({name:"BtnMaxAmount",components:{BtnPlain:s.A},props:{isMax:Boolean},emits:["click"]});var i=n(66262);const u=(0,i.A)(l,[["render",o],["__scopeId","data-v-a1d25678"]]),c=u},15933(e,t,n){n.r(t),n.d(t,{default:()=>z});var a=n(20641);function r(e,t,n,r,o,s){var l,i=(0,a.g2)("TransferSendBase");return(0,a.uX)(),(0,a.Wv)(i,{"current-step":e.currentStep,"sending-disabled":e.error||!(null===(l=e.transferData.addresses)||void 0===l?void 0:l.length)||!e.transferData.amount,onClose:e.resolve,onStepNext:e.proceedToNextStep,onStepPrev:e.editTransfer},{content:(0,a.k6)(function(){return[((0,a.uX)(),(0,a.Wv)((0,a.$y)(e.currentStepConfig.component),{ref:"currentRenderedComponent","transfer-data":e.transferData,"onUpdate:transferData":t[0]||(t[0]=function(t){return e.transferData=t}),onSuccess:e.currentStepConfig.onSuccess,onError:t[1]||(t[1]=function(t){return e.error=t})},null,40,["transfer-data","onSuccess"]))]}),_:1},8,["current-step","sending-disabled","onClose","onStepNext","onStepPrev"])}var o=n(41856),s=n(50953),l=n(18743),i=n(22483),u=n(49476);n(2892);function c(e,t,n,r,o,s){var l=(0,a.g2)("TokenAmount"),i=(0,a.g2)("DetailsItem"),u=(0,a.g2)("TransferReviewBase");return(0,a.uX)(),(0,a.Wv)(u,{"base-token-symbol":e.SOL_COIN_SYMBOL,"transfer-data":e.transferData,loading:e.loading,protocol:e.PROTOCOLS.solana,"show-fiat":e.isSelectedAssetSolanaCoin,class:"transfer-review"},{total:(0,a.k6)(function(){return[e.isSelectedAssetSolanaCoin?((0,a.uX)(),(0,a.Wv)(i,{key:0,label:e.$t("common.total"),class:"details-item"},{value:(0,a.k6)(function(){return[(0,a.bF)(l,{amount:Number(e.transferData.total||0),symbol:e.SOL_COIN_SYMBOL,protocol:e.PROTOCOLS.solana,"data-cy":"review-total","high-precision":""},null,8,["amount","symbol","protocol"])]}),_:1},8,["label"])):(0,a.Q3)("",!0)]}),_:1},8,["base-token-symbol","transfer-data","loading","protocol","show-fiat"])}var d=n(31252),v=n(91744),f=(n(98992),n(3949),n(51629),n(44114),n(18111),n(7588),n(26099),n(23500),n(75220)),m=n(73834),p=n(87087),A=n(15271),b=n(52036),g=n(18494),h=n(24977),y=n(84560),S=function(e,t,n,a){function r(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{i(a.next(e))}catch(t){o(t)}}function l(e){try{i(a["throw"](e))}catch(t){o(t)}}function i(e){e.done?n(e.value):r(e.value).then(s,l)}i((a=a.apply(e,t||[])).next())})};const w=(0,a.pM)({name:"SolanaTransferReview",components:{TokenAmount:h.A,DetailsItem:g.A,TransferReviewBase:b.A},model:{prop:"transferData"},props:{transferData:{type:Object,required:!0}},setup:function(e,t){var n=t.emit,r=(0,m.s9)(),o=r.t,u=(0,f.rd)(),c=(0,i.mv)(),b=c.homeRouteName,g=(0,i.oV)(),h=g.getLastActiveProtocolAccount,w=(0,i.rb)(),k=w.addAccountPendingTransaction,x=(0,s.KR)(!1),C=p.C.getAdapter(l.yv.solana),T=(0,a.EW)(function(){var t,n;return(null===(n=null===(t=e.transferData)||void 0===t?void 0:t.selectedAsset)||void 0===n?void 0:n.contractId)===C.coinContractId});function O(e){y.A.write({title:o("modals.transaction-failed.title"),message:e||o("modals.transaction-failed.msg"),type:"api-response",modal:!0})}function I(){var t;return S(this,void 0,void 0,(0,d.A)().m(function a(){var r,o,s,i,c,f,m,p,A,g,y,S,w,I;return(0,d.A)().w(function(a){while(1)switch(a.p=a.n){case 0:if(r=e.transferData,o=r.amount,s=r.addresses,i=r.selectedAsset,o&&(null===s||void 0===s?void 0:s.length)&&i){a.n=1;break}return a.a(2);case 1:if(x.value=!0,f=h(l.yv.solana),a.p=2,T.value||!(s.length>1)){a.n=4;break}return a.n=3,C.transferTokenBatch(o,s,i.contractId,{fromAccount:null===f||void 0===f?void 0:f.address});case 3:m=a.v,m.forEach(function(e){var t=e.hash,n=e.recipients;n.forEach(function(e){var n={hash:t,pending:!0,transactionOwner:null===f||void 0===f?void 0:f.address,protocol:l.yv.solana,tx:{amount:Number(o),callerId:null===f||void 0===f?void 0:f.address,contractId:i.contractId,senderId:null===f||void 0===f?void 0:f.address,type:"ContractCallTx",function:"transfer",recipientId:e,arguments:[],fee:0}};k(null===f||void 0===f?void 0:f.address,n)})}),a.n=17;break;case 4:if(!(T.value&&s.length>1)){a.n=6;break}return a.n=5,C.spendBatch(Number(o),s,{fromAccount:null===f||void 0===f?void 0:f.address});case 5:p=a.v,p.forEach(function(e){var t=e.hash,n=e.recipients;n.forEach(function(e){var n={hash:t,pending:!0,transactionOwner:null===f||void 0===f?void 0:f.address,protocol:l.yv.solana,tx:{amount:Number(o),callerId:null===f||void 0===f?void 0:f.address,contractId:i.contractId,senderId:null===f||void 0===f?void 0:f.address,type:"SpendTx",function:"transfer",recipientId:e,arguments:[],fee:0}};k(null===f||void 0===f?void 0:f.address,n)})}),a.n=17;break;case 6:A=(0,v.A)(s),a.p=7,A.s();case 8:if((g=A.n()).done){a.n=14;break}if(y=g.value,T.value){a.n=10;break}return a.n=9,null===(t=C.transferToken)||void 0===t?void 0:t.call(C,o,y,i.contractId,{fromAccount:null===f||void 0===f?void 0:f.address});case 9:c=a.v,a.n=12;break;case 10:return a.n=11,C.spend(Number(o),y,{fromAccount:null===f||void 0===f?void 0:f.address});case 11:c=a.v;case 12:c&&(S={hash:c.hash,pending:!0,transactionOwner:null===f||void 0===f?void 0:f.address,protocol:l.yv.solana,tx:{amount:Number(o),callerId:null===f||void 0===f?void 0:f.address,contractId:i.contractId,senderId:null===f||void 0===f?void 0:f.address,type:T.value?"SpendTx":"ContractCallTx",function:"transfer",recipientId:y,arguments:[],fee:0}},k(null===f||void 0===f?void 0:f.address,S));case 13:a.n=8;break;case 14:a.n=16;break;case 15:a.p=15,w=a.v,A.e(w);case 16:return a.p=16,A.f(),a.f(16);case 17:a.n=19;break;case 18:return a.p=18,I=a.v,O(I.message),a.a(2);case 19:return a.p=19,x.value=!1,a.f(19);case 20:u.push({name:b.value}),n("success");case 21:return a.a(2)}},a,null,[[7,15,16,17],[2,18,19,20]])}))}return{PROTOCOLS:l.yv,SOL_COIN_SYMBOL:A.m2,loading:x,isSelectedAssetSolanaCoin:T,submit:I}}});var k=n(66262);const x=(0,k.A)(w,[["render",c],["__scopeId","data-v-78810eaa"]]),C=x;n(76918),n(23288),n(38781);var T=n(53751);function O(e,t,n,r,o,s){var l=(0,a.g2)("TransferSendRecipient"),i=(0,a.g2)("BtnMaxAmount"),u=(0,a.g2)("TransferSendAmount"),c=(0,a.g2)("DetailsItem"),d=(0,a.g2)("TransferSendFormBase");return(0,a.uX)(),(0,a.Wv)(d,(0,a.v6)(e.$attrs,{"transfer-data":e.transferData,fee:e.numericFee,"max-fee":e.numericMaxFee,"fee-symbol":e.SOL_COIN_SYMBOL,protocol:e.PROTOCOLS.solana,"custom-title":e.$t("modals.send.sendAsset",{name:e.SOL_PROTOCOL_NAME}),class:"transfer-send-form"}),{recipient:(0,a.k6)(function(){return[(0,a.bF)(l,{modelValue:e.formModel.addresses,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.formModel.addresses=t}),"max-recipients":10,placeholder:e.recipientPlaceholderText,errors:e.errors,protocol:e.PROTOCOLS.solana,"validation-rules":{account_address:[e.PROTOCOLS.solana]},onOpenQrModal:t[1]||(t[1]=function(t){return e.scanTransferQrCode()})},null,8,["modelValue","placeholder","errors","protocol","validation-rules"])]}),amount:(0,a.k6)(function(){return[(0,a.bF)(u,{modelValue:e.formModel.amount,"onUpdate:modelValue":[t[2]||(t[2]=function(t){return e.formModel.amount=t}),t[3]||(t[3]=function(t){return e.shouldUseMaxAmount=!1})],errors:e.errors,"selected-asset":e.formModel.selectedAsset,protocol:e.PROTOCOLS.solana,"blink-on-change":e.shouldUseMaxAmount,"validation-rules":Object.assign(Object.assign({},+e.balance.minus(e.maxFee)>0?{max_value:e.max}:{}),{enough_coin:[e.maxFee.toString(),e.SOL_COIN_SYMBOL]}),onAssetSelected:e.handleAssetChange},{"label-after":(0,a.k6)(function(){return[(0,a.bF)(i,{"is-max":e.shouldUseMaxAmount,onClick:e.toggleMaxAmount},null,8,["is-max","onClick"])]}),_:1},8,["modelValue","errors","selected-asset","protocol","blink-on-change","validation-rules","onAssetSelected"])]}),extra:(0,a.k6)(function(){return[(0,a.bo)((0,a.bF)(c,{label:e.$t("transaction.fee")},null,8,["label"]),[[T.aG,e.activeNetwork.type!==e.NETWORK_TYPE_TESTNET]])]}),_:1},16,["transfer-data","fee","max-fee","fee-symbol","protocol","custom-title"])}n(72577),n(50113),n(20116),n(9868),n(54520),n(81454),n(62953),n(2008),n(23418),n(62062),n(22489),n(61701),n(47764);var I=n(60346),E=n(1539),F=n(48625),_=n(49215),B=n(46578),M=n(75716),R=function(e,t,n,a){function r(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{i(a.next(e))}catch(t){o(t)}}function l(e){try{i(a["throw"](e))}catch(t){o(t)}}function i(e){e.done?n(e.value):r(e.value).then(s,l)}i((a=a.apply(e,t||[])).next())})};function N(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.KR)(1),t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=(0,M.f)(),o=r.activeNetwork,l=(0,s.KR)(0),i=(0,s.KR)(new I.A(0)),u=(0,a.EW)(function(){return[{fee:i.value,time:60,label:(0,B.tg)("common.transferSpeed.medium")}]}),c=(0,a.EW)(function(){return u.value[l.value].fee}),v=c;function f(){var a,r;return R(this,void 0,void 0,(0,d.A)().m(function s(){var l,u,c,v,f,m,p,b,g,h,y,S,w,k,x,C,T,O,B=this;return(0,d.A)().w(function(s){while(1)switch(s.p=s.n){case 0:return s.p=0,l=o.value.protocols.solana.nodeUrl,u=new E.Ng(l,"confirmed"),c=new E.J3(t||"11111111111111111111111111111111"),s.n=1,u.getLatestBlockhash("finalized");case 1:for(v=s.v,f=v.blockhash,m=new E.ZX({recentBlockhash:f,feePayer:c}),p=0;p<(e.value||1);p++)m.add(E.yq.transfer({fromPubkey:c,toPubkey:c,lamports:0}));return b=5e3,s.p=2,g=m.compileMessage(),s.n=3,u.getFeeForMessage(g,"confirmed");case 3:h=s.v,b=Number((null===h||void 0===h?void 0:h.value)||b),s.n=5;break;case 4:s.p=4,s.v;case 5:if(s.p=5,y="string"===typeof(null===n||void 0===n?void 0:n.selectedAssetContractId)?null===n||void 0===n?void 0:n.selectedAssetContractId:null===(a=null===n||void 0===n?void 0:n.selectedAssetContractId)||void 0===a?void 0:a.value,!y||y===A.YL){s.n=9;break}return S=(null===(r=null===n||void 0===n?void 0:n.recipients)||void 0===r?void 0:r.value)||[],w=S.length||e.value||1,k=new E.J3(y),s.n=6,Promise.all((S.length?S:Array.from({length:w}).map(function(e,t){return t})).map(function(e){return R(B,void 0,void 0,(0,d.A)().m(function t(){var n,a;return(0,d.A)().w(function(t){while(1)switch(t.n){case 0:return n="string"===typeof e?e:c.toBase58(),a=new E.J3(n),t.a(2,(0,F.Ob)(k,a,!1,_.x5,_.EK))}},t)}))}));case 6:return x=s.v,s.n=7,u.getMultipleAccountsInfo(x);case 7:if(C=s.v,T=C.filter(function(e){return null==e}).length,!(T>0)){s.n=9;break}return s.n=8,u.getMinimumBalanceForRentExemption(165);case 8:O=s.v,b+=T*O;case 9:s.n=11;break;case 10:s.p=10,s.v;case 11:i.value=new I.A(b/E.Sr),s.n=13;break;case 12:s.p=12,s.v,i.value=new I.A(5e-6);case 13:return s.a(2)}},s,null,[[5,10],[2,4],[0,12]])}))}return{fee:c,feeList:u,feeSelectedIndex:l,maxFee:v,updateFeeList:f}}var D=n(34620),L=n(93690),P=n(96881),W=n(63366);function $(e){var t=(0,L.t)(),n=t.balance,r=(0,a.EW)(function(){var t,n;return(null===(n=null===(t=e.value)||void 0===t?void 0:t.addresses)||void 0===n?void 0:n.length)||1}),o=N(r),s=o.fee,i=o.updateFeeList,u=(0,a.EW)(function(){var t;return new I.A((null===(t=e.value)||void 0===t?void 0:t.amount)||0).plus(s.value||0)}),c=(0,a.EW)(function(){var t,a,o,i,u,c=p.C.getAdapter(l.yv.solana),d=(null===(a=null===(t=e.value)||void 0===t?void 0:t.selectedAsset)||void 0===a?void 0:a.contractId)===c.coinContractId;if(d&&n.value){var v=new I.A(n.value).minus(s.value||0),f=v.div(r.value),m=(null===(i=null===(o=e.value)||void 0===o?void 0:o.selectedAsset)||void 0===i?void 0:i.decimals)||c.coinPrecision;return(f.isPositive()?f:new I.A(0)).decimalPlaces(m).toString()}var A=null===(u=e.value)||void 0===u?void 0:u.selectedAsset;if(null!=(null===A||void 0===A?void 0:A.amount)){var b=new I.A((0,P.Y9)(A.amount,-(A.decimals||0))||0);return b.toString()}return"0"}),d=(0,W.A)(function(){return i()},500);return(0,a.sV)(function(){i()}),(0,a.wB)(function(){var t,n,a;return[null===(t=e.value)||void 0===t?void 0:t.selectedAsset,null===(n=e.value)||void 0===n?void 0:n.addresses,null===(a=e.value)||void 0===a?void 0:a.amount]},function(){return d()},{deep:!0}),{max:c,fee:s,total:u}}var V=n(10483),X=n(62559),j=n(18381),q=n(2915),Q=function(e,t,n,a){function r(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{i(a.next(e))}catch(t){o(t)}}function l(e){try{i(a["throw"](e))}catch(t){o(t)}}function i(e){e.done?n(e.value):r(e.value).then(s,l)}i((a=a.apply(e,t||[])).next())})};const U=(0,a.pM)({name:"SolTransferSendForm",components:{BtnMaxAmount:q.A,DetailsItem:g.A,TransferSendAmount:j.A,TransferSendRecipient:X.A,TransferSendFormBase:V.A},model:{prop:"transferData"},props:{transferData:{type:Object,required:!0}},emits:["update:transferData","success","error"],setup:function(e,t){var n,r=this,o=t.emit,u=(0,m.s9)(),c=u.t,v=(0,i.fI)(),f=v.activeNetwork,b=(0,i.ZN)(),g=b.marketData,h=(0,i.ty)(),y=h.balance,S=(0,i.oV)(),w=S.activeAccount,k=(0,i.Sr)(),x=k.accountAssets;function C(e,t){return e?x.value.find(function(t){var n=t.contractId;return n===e}):t?void 0:p.C.getAdapter(l.yv.solana).getDefaultCoin(g.value,+y.value)}var T=(0,D.x)({transferData:e.transferData,getSelectedAssetValue:C}),O=T.formModel,I=T.errors,E=T.hasError,F=T.invoiceId,_=T.invoiceContract,B=T.scanTransferQrCode,M=T.handleAssetChange,R=(0,a.EW)(function(){var e;return(null===(e=O.value.addresses)||void 0===e?void 0:e.length)||1}),L=(0,a.EW)(function(){return O.value.addresses||[]}),W=(0,a.EW)(function(){var e;return null===(e=O.value.selectedAsset)||void 0===e?void 0:e.contractId}),V=N(R,null===(n=w.value)||void 0===n?void 0:n.address,{recipients:L,selectedAssetContractId:W}),X=V.fee,j=V.maxFee,q=V.feeList,U=V.feeSelectedIndex,K=V.updateFeeList,G=(0,s.KR)(!1),Y=$(O),H=Y.max,z=(0,a.EW)(function(){return+X.value.toFixed()}),J=(0,a.EW)(function(){return+j.value.toFixed()}),Z=c("modals.send.recipientPlaceholderProtocol",{name:l.yv.solana});function ee(){var e,t=Object.assign(Object.assign({},O.value),{fee:X.value,total:z.value+ +((null===(e=O.value)||void 0===e?void 0:e.amount)||0)*R.value,invoiceId:F.value,invoiceContract:_.value});return o("update:transferData",t),(0,a.dY)()}function te(){return Q(this,void 0,void 0,(0,d.A)().m(function e(){return(0,d.A)().w(function(e){while(1)switch(e.n){case 0:if(E.value){e.n=2;break}return e.n=1,ee();case 1:o("success");case 2:return e.a(2)}},e)}))}function ne(){G.value=!G.value,G.value&&(O.value.amount=H.value)}var ae=null;return(0,a.sV)(function(){ae=(0,P.mX)(function(){return Q(r,void 0,void 0,(0,d.A)().m(function e(){return(0,d.A)().w(function(e){while(1)switch(e.n){case 0:K();case 1:return e.a(2)}},e)}))},5e3)}),(0,a.hi)(function(){ae&&clearInterval(ae)}),(0,a.wB)(function(){return[O.value.selectedAsset,O.value.addresses]},function(){return Q(r,void 0,void 0,(0,d.A)().m(function e(){return(0,d.A)().w(function(e){while(1)switch(e.n){case 0:K();case 1:return e.a(2)}},e)}))},{deep:!0}),(0,a.wB)(H,function(e){G.value&&(O.value.amount=e)}),(0,a.wB)(E,function(e){return o("error",e)},{deep:!0}),(0,a.wB)(O,function(){ee()},{deep:!0}),{SOL_PROTOCOL_NAME:A.g9,SOL_COIN_SYMBOL:A.m2,PROTOCOLS:l.yv,NETWORK_TYPE_TESTNET:l.Oj,formModel:O,activeNetwork:f,maxFee:j,feeList:q,recipientPlaceholderText:Z,feeSelectedIndex:U,numericFee:z,numericMaxFee:J,errors:I,balance:y,max:H,recipientsCount:R,shouldUseMaxAmount:G,scanTransferQrCode:B,handleAssetChange:M,submit:te,toggleMaxAmount:ne}}}),K=(0,k.A)(U,[["render",O]]),G=K,Y=(0,a.pM)({name:l.iP,components:{TransferSendBase:u.A},props:Object.assign(Object.assign({},u.g),{tokenContractId:{type:String,default:null}}),setup:function(e){var t=(0,i.Y7)(),n=t.getProtocolAvailableTokens,r=(0,a.EW)(function(){return n(l.yv.solana)}),u=(0,s.KR)(),c=(0,s.KR)(l.x0.form),d=(0,s.KR)(!1),v=(0,s.KR)({addresses:e.address?[e.address]:[],amount:e.amount,payload:e.payload,selectedAsset:e.tokenContractId?r.value[e.tokenContractId]:void 0});function f(){u.value.submit()}function m(){c.value=l.x0.review}function p(){d.value=!1,c.value=l.x0.form}var A=(0,o.A)((0,o.A)({},l.x0.form,{component:G,onSuccess:m}),l.x0.review,{component:C,onSuccess:e.resolve}),b=(0,a.EW)(function(){return A[c.value]});return{TRANSFER_SEND_STEPS:l.x0,currentRenderedComponent:u,steps:A,currentStep:c,error:d,transferData:v,currentStepConfig:b,proceedToNextStep:f,editTransfer:p}}}),H=(0,k.A)(Y,[["render",r]]),z=H}}]);