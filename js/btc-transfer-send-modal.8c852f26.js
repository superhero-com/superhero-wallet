"use strict";(self["webpackChunksuperhero_wallet"]=self["webpackChunksuperhero_wallet"]||[]).push([[3875],{2915:(e,t,n)=>{n.d(t,{A:()=>c});var a=n(20641),r=n(90033);function o(e,t,n,o,s,l){var i=(0,a.g2)("BtnPlain");return(0,a.uX)(),(0,a.Wv)(i,{class:(0,r.C4)(["max-button",{chosen:e.isMax}]),text:e.$t("common.max"),onClick:t[0]||(t[0]=function(t){return e.$emit("click")})},null,8,["class","text"])}var s=n(77389);const l=(0,a.pM)({name:"BtnMaxAmount",components:{BtnPlain:s.A},props:{isMax:Boolean},emits:["click"]});var i=n(66262);const u=(0,i.A)(l,[["render",o],["__scopeId","data-v-a1d25678"]]),c=u},10483:(e,t,n)=>{n.d(t,{A:()=>f});n(62010);var a=n(20641),r={class:"transfer-send-base"},o={class:"account-row"};function s(e,t,n,s,l,i){var u=(0,a.g2)("ModalHeader"),c=(0,a.g2)("AccountItem"),d=(0,a.g2)("TokenAmount"),v=(0,a.g2)("DetailsItem");return(0,a.uX)(),(0,a.CE)("div",r,[e.$slots.header?(0,a.RG)(e.$slots,"header",{key:0},void 0,!0):((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.bF)(u,{title:e.customTitle||e.$t("modals.send.sendTitle")},null,8,["title"]),(0,a.Lk)("div",o,[(0,a.bF)(c,{address:e.activeAccount.address,protocol:e.activeAccount.protocol,name:e.activeAccount.name,size:"md"},null,8,["address","protocol","name"])])],64)),(0,a.RG)(e.$slots,"recipient",{},void 0,!0),(0,a.RG)(e.$slots,"amount",{},void 0,!0),(0,a.RG)(e.$slots,"extra",{},void 0,!0),(0,a.bF)(v,{label:e.maxFee?e.$t("transaction.estimatedFee"):e.$t("transaction.fee")},{value:(0,a.k6)((function(){return[(0,a.bF)(d,{amount:e.fee,symbol:e.feeSymbol,protocol:e.protocol,"blink-on-change":"","data-cy":"review-fee"},null,8,["amount","symbol","protocol"])]})),_:1},8,["label"]),e.maxFee?((0,a.uX)(),(0,a.Wv)(v,{key:2,label:e.$t("transaction.maxFee")},{value:(0,a.k6)((function(){return[(0,a.bF)(d,{amount:e.maxFee,symbol:e.feeSymbol,protocol:e.protocol,"blink-on-change":"","data-cy":"review-max-fee"},null,8,["amount","symbol","protocol"])]})),_:1},8,["label"])):(0,a.Q3)("",!0)])}n(2892);var l=n(64101),i=n(18494),u=n(24977),c=n(40919),d=n(33521);const v=(0,a.pM)({name:"TransferSendFormBase",components:{ModalHeader:c.A,AccountItem:d.A,DetailsItem:i.A,TokenAmount:u.A},props:{fee:{type:Number,default:0},maxFee:{type:Number,default:void 0},feeSymbol:{type:String,required:!0},customTitle:{type:String,default:""},protocol:{type:String,required:!0}},setup:function(){var e=(0,l.oV)(),t=e.activeAccount;return{activeAccount:t}}});var p=n(66262);const m=(0,p.A)(v,[["render",s],["__scopeId","data-v-cdc4500e"]]),f=m},22915:(e,t,n)=>{n.d(t,{A:()=>A});var a=n(20641),r=n(90033),o={class:"address-container"};function s(e,t,n,s,l,i){var u=(0,a.g2)("Avatar"),c=(0,a.g2)("AddressFormatted");return(0,a.uX)(),(0,a.CE)("div",{class:(0,r.C4)(["avatar-with-chain-name",{"only-name":!e.showAddress&&!e.hideAvatar}]),style:(0,r.Tr)({"background-color":e.color})},[e.hideAvatar?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(u,(0,a.v6)({key:0},e.$attrs,{size:e.avatarSize,address:e.localChainNameAddress||e.address}),null,16,["size","address"])),(0,a.Lk)("div",o,[e.calculatedName?((0,a.uX)(),(0,a.CE)("div",{key:0,class:(0,r.C4)(["address-name",{centered:e.hideAvatar}])},(0,r.v_)(e.calculatedName),3)):(0,a.Q3)("",!0),e.showAddress?((0,a.uX)(),(0,a.Wv)(c,(0,a.v6)({key:1},e.$attrs,{address:e.localChainNameAddress||e.address,class:"text-address",columns:""}),null,16,["address"])):(0,a.Q3)("",!0)])],6)}n(98992),n(54520),n(37550),n(2008),n(15086),n(62010),n(18111),n(22489),n(13579),n(26099);var l=n(96881),i=n(64101),u=n(2205),c=n(59579),d=n(64224),v=n(68683),p=n(15059);const m=(0,a.pM)({components:{AddressFormatted:p.A,Avatar:v.A},props:{address:{type:String,required:!0},name:{type:String,default:""},hideAvatar:Boolean,avatarSize:{type:String,default:"md"},protocol:{type:String,required:!0}},setup:function(e){var t=(0,i.oV)(),n=t.accountsGroupedByProtocol,r=(0,i.Gf)(),o=r.allAccounts,s=(0,c.q)(),v=s.ownedNames,p=(0,i.ci)(),m=p.multisigAccounts;function f(t){var a;return(null===(a=n.value[e.protocol])||void 0===a?void 0:a.some((function(e){return e.address===t})))||m.value.some((function(e){return e.gaAccountId===t}))}var b=(0,a.EW)((function(){return o.value.filter((function(t){return t.address===e.address}))[0]})),A=(0,a.EW)((function(){var t=v.value.filter((function(t){return t.name===e.name&&t.pointers.accountPubkey}))[0];return t?t.pointers.accountPubkey:""})),g=(0,a.EW)((function(){var t;return e.name||A.value||(null===(t=b.value)||void 0===t?void 0:t.name)||(0,u.tg)("modals.send.recipientLabel")})),y=(0,a.EW)((function(){return!(0,d.wJ)(e.address)||A.value})),h=(0,a.EW)((function(){return e.address&&!(0,d.wJ)(e.address)&&f(e.address)||A.value?(0,l.cr)(A.value||e.address):void 0}));return{showAddress:y,localChainNameAddress:A,calculatedName:g,color:h}}});var f=n(66262);const b=(0,f.A)(m,[["render",s],["__scopeId","data-v-4979f97a"]]),A=b},34620:(e,t,n)=>{n.d(t,{x:()=>g});var a=n(95383),r=n(34916),o=n(70068),s=(n(98992),n(72577),n(3949),n(81454),n(76918),n(28706),n(50113),n(51629),n(62062),n(15086),n(23288),n(62010),n(18111),n(20116),n(7588),n(61701),n(53921),n(79432),n(26099),n(27495),n(38781),n(47764),n(25440),n(42762),n(23500),n(62953),n(3296),n(27208),n(48408),n(14603),n(47566),n(98721),n(50953)),l=n(20641),i=n(73834),u=n(81268),c=n(93909),d=n(18743),v=n(96881),p=n(84560),m=n(53611),f=n(69264),b=n(96605),A=function(e,t,n,a){function r(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function s(e){try{i(a.next(e))}catch(t){o(t)}}function l(e){try{i(a["throw"](e))}catch(t){o(t)}}function i(e){e.done?n(e.value):r(e.value).then(s,l)}i((a=a.apply(e,t||[])).next())}))};function g(e){var t=e.transferData,n=e.getSelectedAssetValue,g=(0,s.KR)(t),y=(0,s.KR)(null),h=(0,s.KR)(null),S=(0,i.s9)(),x=S.t,w=(0,c.U)(),k=w.openDefaultModal,T=w.openScanQrModal,C=(0,u.mN)(),E=C.errors,O=C.validate,B=C.validateField,R=(0,f.t)(),_=R.saveTransferSendFormModel,F=(0,b.S)(),M=F.accountAssets,I=(0,l.EW)((function(){return["addresses","amount"].some((function(e){return"error"===(0,v.sY)(E.value[e]).status}))}));function D(){g.value.payload=""}function N(e){g.value.selectedAsset=e}function P(e,t){var n,a=e.account,r=e.amount,s=e.payload,l=e.token,i={},u=t?t(l,g.value.selectedAsset):null;return u&&(i.selectedAsset=u),a&&(i.addresses=[a].concat((0,o.A)(null!==(n=g.value.addresses)&&void 0!==n?n:[]))),r&&(i.amount=r),s&&(i.payload=s),i}function W(e){return A(this,void 0,void 0,(0,r.A)().mark((function t(){var a;return(0,r.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=P(e,n),g.value=Object.assign(Object.assign({},g.value),a),t.next=4,(0,l.dY)();case 4:Object.keys(a).forEach((function(e){return B(e)}));case 5:case"end":return t.stop()}}),t)})))}function L(){var e,t;return A(this,void 0,void 0,(0,r.A)().mark((function n(){var s,l,i;return(0,r.A)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,T({title:x("pages.send.scanAddress",{assetName:null===(e=g.value.selectedAsset)||void 0===e?void 0:e.name})}).then((function(e){return e}))["catch"]((function(e){return e instanceof m.yr&&_(g.value),null}));case 2:if(s=n.sent,"{"!==(null===s||void 0===s?void 0:s.trim().charAt(0))){n.next=29;break}l=null,n.prev=5,l=JSON.parse(s),n.next=15;break;case 9:return n.prev=9,n.t0=n["catch"](5),d.p8||p.A.write(n.t0),g.value.addresses=void 0,k({title:x("modals.invalid-qr-code.msg"),icon:"critical"}),n.abrupt("return");case 15:if(i=M.value.find((function(e){var t=e.contractId;return t===l.tokenContract})),i){n.next=20;break}return g.value.addresses=void 0,k({msg:x("modals.insufficient-balance.msg")}),n.abrupt("return");case 20:return g.value.selectedAsset=i,g.value.addresses=[l.tokenContract],g.value.amount=(0,v.Y9)(l.amount,-((null===(t=g.value.selectedAsset)||void 0===t?void 0:t.decimals)||-0)).toString(),y.value=l.invoiceId,h.value=l.invoiceContract,n.next=27,O();case 27:n.next=33;break;case 29:if(s){n.next=31;break}return n.abrupt("return");case 31:W(Object.fromEntries((0,o.A)(new URL((0,v.Ks)(s)?s:"".concat(d.yS,"/account?account=").concat(s.replace("?","&"))).searchParams.entries()).map((function(e){var t=(0,a.A)(e,2),n=t[0],r=t[1];return[n,r]})))),y.value=null;case 33:g.value.addresses||(g.value.addresses=void 0);case 34:case"end":return n.stop()}}),n,null,[[5,9]])})))}return{formModel:g,errors:E,hasError:I,invoiceId:y,invoiceContract:h,scanTransferQrCode:L,clearPayload:D,handleAssetChange:N,validate:O,updateFormModelValues:W}}},43036:(e,t,n)=>{n.d(t,{J:()=>i});n(76918),n(23288),n(26099),n(38781);var a=n(20641),r=n(60346),o=n(64101),s=n(87087),l=n(96881);function i(e){var t=e.formModel,n=e.fee,i=(0,o.ty)(),u=i.balance,c=(0,a.EW)((function(){var e,n,a,r;if(!(null===(e=t.value.selectedAsset)||void 0===e?void 0:e.protocol))return!1;var o=s.C.getAdapter(null===(n=t.value.selectedAsset)||void 0===n?void 0:n.protocol);return(null===(r=null===(a=t.value)||void 0===a?void 0:a.selectedAsset)||void 0===r?void 0:r.contractId)===o.coinContractId})),d=(0,a.EW)((function(){var e,n;return new r.A((0,l.Y9)(null===(e=t.value.selectedAsset)||void 0===e?void 0:e.amount,-((null===(n=t.value.selectedAsset)||void 0===n?void 0:n.decimals)||-0))||0)})),v=(0,a.EW)((function(){var e,a;if(u.value&&c.value){var r=u.value.minus(n.value).dividedBy((null===(e=t.value.addresses)||void 0===e?void 0:e.length)||1).decimalPlaces(null===(a=t.value.selectedAsset)||void 0===a?void 0:a.decimals);return(r.isPositive()?r:0).toString()}return d.value.toString()}));return{max:v}}},44397:(e,t,n)=>{n.r(t),n.d(t,{default:()=>K});var a=n(20641);function r(e,t,n,r,o,s){var l,i=(0,a.g2)("TransferSendBase");return(0,a.uX)(),(0,a.Wv)(i,{protocol:e.PROTOCOLS.bitcoin,"current-step":e.currentStep,"sending-disabled":e.error||!(null===(l=e.transferData.addresses)||void 0===l?void 0:l.length)||!e.transferData.amount,onClose:e.resolve,onStepNext:e.proceedToNextStep,onStepPrev:e.editTransfer},{content:(0,a.k6)((function(){return[((0,a.uX)(),(0,a.Wv)((0,a.$y)(e.currentStepConfig.component),{ref:"currentRenderedComponent","transfer-data":e.transferData,"onUpdate:transferData":t[0]||(t[0]=function(t){return e.transferData=t}),onSuccess:e.currentStepConfig.onSuccess,onError:t[1]||(t[1]=function(t){return e.error=t})},null,40,["transfer-data","onSuccess"]))]})),_:1},8,["protocol","current-step","sending-disabled","onClose","onStepNext","onStepPrev"])}var o=n(41856),s=n(50953),l=n(18743),i=n(87087),u=n(64101),c=n(81282);function d(e,t,n,r,o,s){var l=(0,a.g2)("TokenAmount"),i=(0,a.g2)("DetailsItem"),u=(0,a.g2)("TransferReviewBase");return(0,a.uX)(),(0,a.Wv)(u,{"base-token-symbol":e.BTC_SYMBOL,"transfer-data":e.transferData,loading:e.loading,"show-fiat":"",protocol:e.PROTOCOLS.bitcoin,class:"transfer-review"},{total:(0,a.k6)((function(){return[(0,a.bF)(i,{label:e.$t("common.total"),class:"details-item"},{value:(0,a.k6)((function(){return[(0,a.bF)(l,{amount:+e.transferData.total,symbol:e.BTC_SYMBOL,"high-precision":"",protocol:e.PROTOCOLS.bitcoin,"data-cy":"review-total"},null,8,["amount","symbol","protocol"])]})),_:1},8,["label"])]})),_:1},8,["base-token-symbol","transfer-data","loading","protocol"])}var v=n(91744),p=n(34916),m=(n(74423),n(44114),n(2892),n(26099),n(21699),n(76031),n(75220)),f=n(73834),b=n(52036),A=n(18494),g=n(24977),y=n(74731),h=n(60346),S=n(84560),x=function(e,t,n,a){function r(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function s(e){try{i(a.next(e))}catch(t){o(t)}}function l(e){try{i(a["throw"](e))}catch(t){o(t)}}function i(e){e.done?n(e.value):r(e.value).then(s,l)}i((a=a.apply(e,t||[])).next())}))};const w=(0,a.pM)({name:"BtcTransferReview",components:{TokenAmount:g.A,DetailsItem:A.A,TransferReviewBase:b.A},model:{prop:"transferData"},props:{transferData:{type:Object,required:!0}},setup:function(e,t){var n=t.emit,a=(0,f.s9)(),r=a.t,o=(0,m.rd)(),c=(0,u.mv)(),d=c.homeRouteName,b=(0,u.oV)(),A=b.activeAccount,g=b.getLastActiveProtocolAccount,w=(0,u.rb)(),k=w.addAccountPendingTransaction,T=(0,s.KR)(!1);function C(e){S.A.write({title:r("modals.transaction-failed.title"),message:e||r("modals.transaction-failed.msg"),type:"api-response",modal:!0})}function E(e){var t=document.createElement("textarea");return t.textContent=e,t.innerHTML}function O(t){var n,a,o=t.amount,s=t.recipient;return x(this,void 0,void 0,(0,p.A)().mark((function t(){var u,c,d,v;return(0,p.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return u=i.C.getAdapter(l.yv.bitcoin),t.prev=1,t.next=4,u.spend((0,h.A)(o).toNumber(),s,Object.assign({fee:null===(n=e.transferData.fee)||void 0===n?void 0:n.dividedBy((null===(a=e.transferData.addresses)||void 0===a?void 0:a.length)||1).toNumber()},A.value));case 4:return c=t.sent,d=c.hash,t.abrupt("return",d);case 9:return t.prev=9,t.t0=t["catch"](1),v=E(t.t0.message),v.includes("dust")?C(r("modals.transaction-failed.dustError")):C(v),t.abrupt("return",void 0);case 14:case"end":return t.stop()}}),t,null,[[1,9]])})))}function B(){var t,a;return x(this,void 0,void 0,(0,p.A)().mark((function r(){var s,i,u,c,m,f,b,A,y,h;return(0,p.A)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(s=e.transferData,i=s.amount,u=s.addresses,c=s.selectedAsset,i&&(null===u||void 0===u?void 0:u.length)&&c){r.next=3;break}return r.abrupt("return");case 3:T.value=!0,m=(0,v.A)(u),r.prev=5,m.s();case 7:if((f=m.n()).done){r.next=17;break}return b=f.value,r.next=11,O({amount:i,recipient:b,selectedAsset:c});case 11:return A=r.sent,A&&(y=g(l.yv.bitcoin),h={hash:A,pending:!0,transactionOwner:null===y||void 0===y?void 0:y.address,protocol:l.yv.bitcoin,tx:{amount:Number(i),callerId:null===y||void 0===y?void 0:y.address,contractId:c.contractId,senderId:null===y||void 0===y?void 0:y.address,type:"SpendTx",recipientId:b,arguments:[],fee:null!==(a=null===(t=e.transferData.fee)||void 0===t?void 0:t.dividedBy(u.length).toNumber())&&void 0!==a?a:0}},k(null===y||void 0===y?void 0:y.address,h)),r.next=15,new Promise((function(e){return setTimeout(e,1e4)}));case 15:r.next=7;break;case 17:r.next=22;break;case 19:r.prev=19,r.t0=r["catch"](5),m.e(r.t0);case 22:return r.prev=22,m.f(),r.finish(22);case 25:T.value=!1,o.push({name:d.value}),n("success");case 28:case"end":return r.stop()}}),r,null,[[5,19,22,25]])})))}return{PROTOCOLS:l.yv,BTC_SYMBOL:y.HF,loading:T,submit:B}}});var k=n(66262);const T=(0,k.A)(w,[["render",d],["__scopeId","data-v-c16bd99c"]]),C=T;n(76918),n(23288),n(38781);var E=n(53751);function O(e,t,n,r,o,s){var l=(0,a.g2)("TransferSendRecipient"),i=(0,a.g2)("BtnMaxAmount"),u=(0,a.g2)("TransferSendAmount"),c=(0,a.g2)("TransactionSpeedPicker"),d=(0,a.g2)("DetailsItem"),v=(0,a.g2)("TransferSendFormBase");return(0,a.uX)(),(0,a.Wv)(v,(0,a.v6)(e.$attrs,{"transfer-data":e.transferData,fee:e.numericFee,"fee-symbol":e.BTC_SYMBOL,protocol:e.PROTOCOLS.bitcoin,"custom-title":e.$t("modals.send.sendAsset",{name:e.BTC_PROTOCOL_NAME}),class:"transfer-send-form"}),{recipient:(0,a.k6)((function(){return[(0,a.bF)(l,{modelValue:e.formModel.addresses,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.formModel.addresses=t}),"max-recipients":10,placeholder:e.$t("modals.send.recipientPlaceholderProtocol",{name:e.PROTOCOLS.bitcoin}),errors:e.errors,protocol:e.PROTOCOLS.bitcoin,"validation-rules":{account_address:[e.PROTOCOLS.bitcoin,e.activeNetwork.type]},onOpenQrModal:t[1]||(t[1]=function(t){return e.scanTransferQrCode()})},null,8,["modelValue","placeholder","errors","protocol","validation-rules"])]})),amount:(0,a.k6)((function(){return[(0,a.bF)(u,{modelValue:e.formModel.amount,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.formModel.amount=t}),errors:e.errors,"selected-asset":e.formModel.selectedAsset,readonly:"",protocol:e.PROTOCOLS.bitcoin,"validation-rules":Object.assign(Object.assign(Object.assign({},+e.balance.minus(e.fee)>0?{max_value:e.max.toString()}:{}),{enough_coin:[e.fee.toString(),e.BTC_SYMBOL]}),e.activeNetwork.type===e.NETWORK_TYPE_TESTNET?{}:{min_value_exclusive:e.toBitcoin(e.DUST_AMOUNT)}),onAssetSelected:e.handleAssetChange},{"label-after":(0,a.k6)((function(){return[(0,a.bF)(i,{"is-max":e.shouldUseMaxAmount,onClick:e.toggleMaxAmount},null,8,["is-max","onClick"])]})),_:1},8,["modelValue","errors","selected-asset","protocol","validation-rules","onAssetSelected"])]})),extra:(0,a.k6)((function(){return[(0,a.bo)((0,a.bF)(d,{label:e.$t("modals.send.transactionSpeed")},{value:(0,a.k6)((function(){return[(0,a.bF)(c,{modelValue:e.feeSelectedIndex,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.feeSelectedIndex=t}),"fee-list":e.feeList},null,8,["modelValue","fee-list"])]})),_:1},8,["label"]),[[E.aG,e.activeNetwork.type!==e.NETWORK_TYPE_TESTNET]])]})),_:1},16,["transfer-data","fee","fee-symbol","protocol","custom-title"])}n(9868);var B=n(14673),R=n(34620),_=n(43036),F=n(96881),M=n(88712),I=n(10483),D=n(62559),N=n(18381),P=n(90415),W=n(2915),L=function(e,t,n,a){function r(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function s(e){try{i(a.next(e))}catch(t){o(t)}}function l(e){try{i(a["throw"](e))}catch(t){o(t)}}function i(e){e.done?n(e.value):r(e.value).then(s,l)}i((a=a.apply(e,t||[])).next())}))};const $=(0,a.pM)({name:"BtcTransferSendForm",components:{BtnMaxAmount:W.A,TransactionSpeedPicker:P.A,DetailsItem:A.A,TransferSendAmount:N.A,TransferSendRecipient:D.A,TransferSendFormBase:I.A},model:{prop:"transferData"},props:{transferData:{type:Object,required:!0}},emits:["update:transferData","success","error"],setup:function(e,t){var n=t.emit,r=i.C.getAdapter(l.yv.bitcoin),o=(0,m.lq)(),c=(0,f.s9)(),d=c.t,v=(0,u.fI)(),b=v.activeNetwork,A=(0,u.ty)(),g=A.balance,x=(0,u.oV)(),w=x.activeAccount,k=(0,s.KR)(!1),T=(0,s.KR)(!1),C=(0,s.KR)(!1),E=(0,R.x)({transferData:e.transferData}),O=E.formModel,I=E.errors,D=E.hasError,N=E.invoiceId,P=E.invoiceContract,W=E.clearPayload,$=E.handleAssetChange,V=E.scanTransferQrCode,X=E.updateFormModelValues,U=(0,s.KR)(1),j=(0,s.KR)(new h.A(2e-5)),K=(0,s.KR)(new h.A(2e-5)),Q=(0,s.KR)(new h.A(2e-5)),q=(0,a.EW)((function(){var e;return(null===(e=O.value.addresses)||void 0===e?void 0:e.length)||1})),G=(0,a.EW)((function(){return[{fee:j.value,time:3540,label:d("common.transferSpeed.slow")},{fee:K.value,time:600,label:d("common.transferSpeed.medium")},{fee:Q.value,time:25,label:d("common.transferSpeed.fast")}]})),Y=(0,a.EW)((function(){return G.value[U.value].fee.multipliedBy(q.value)})),H=(0,a.EW)((function(){return+Y.value.toFixed()})),J=(0,_.J)({formModel:O,fee:Y}),z=J.max;function Z(){var e,t=Object.assign(Object.assign({},O.value),{fee:Y.value,total:H.value+ +((null===(e=O.value)||void 0===e?void 0:e.amount)||0)*q.value,invoiceId:N.value,invoiceContract:P.value});return n("update:transferData",t),(0,a.dY)()}function ee(){return L(this,void 0,void 0,(0,p.A)().mark((function e(){return(0,p.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(D.value){e.next=4;break}return e.next=3,Z();case 3:n("success");case 4:case"end":return e.stop()}}),e)})))}function te(){C.value=!C.value,C.value&&(O.value.amount=z.value)}function ne(){var e;return L(this,void 0,void 0,(0,p.A)().mark((function t(){var n,a,o,s,i;return(0,p.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.constructAndSignTx(0,(null===(e=O.value.addresses)||void 0===e?void 0:e[0])||w.value.address,Object.assign({fee:0},w.value));case 3:return n=t.sent.virtualSize(),a=b.value.protocols.bitcoin.nodeUrl,t.next=7,(0,F.x6)("".concat(a,"/fee-estimates"));case 7:o=t.sent["5"],s=new h.A(.5),i=new h.A(Math.ceil(o*n)),j.value=new h.A((0,B.toBitcoin)(Math.ceil(i.minus(i.times(s)).toNumber()))),K.value=new h.A((0,B.toBitcoin)(i.toNumber()*(b.value.type===l.Oj?2:1))),Q.value=new h.A((0,B.toBitcoin)(Math.ceil(i.plus(i.times(s)).toNumber()))),t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](0),S.A.write(t.t0);case 18:case"end":return t.stop()}}),t,null,[[0,15]])})))}var ae=null;return(0,a.sV)((function(){ae=(0,F.mX)((function(){ne()}),5e3);var e=o.query;X(Object.assign(Object.assign({},e),{token:e.token}))})),(0,a.hi)((function(){ae&&clearInterval(ae)})),(0,a.wB)(z,(function(e){C.value&&(O.value.amount=e)})),(0,a.wB)(D,(function(e){return n("error",e)}),{deep:!0}),(0,a.wB)(O,(function(){Z()}),{deep:!0}),{INFO_BOX_TYPES:M.F,BTC_PROTOCOL_NAME:y.NS,BTC_SYMBOL:y.HF,DUST_AMOUNT:y.uR,PROTOCOLS:l.yv,NETWORK_TYPE_TESTNET:l.Oj,hasMultisigTokenWarning:k,formModel:O,isUrlTippingEnabled:T,activeNetwork:b,fee:Y,feeList:G,feeSelectedIndex:U,numericFee:H,activeAccount:w,errors:I,balance:g,max:z,clearPayload:W,shouldUseMaxAmount:C,scanTransferQrCode:V,handleAssetChange:$,submit:ee,toggleMaxAmount:te,toBitcoin:B.toBitcoin}}}),V=(0,k.A)($,[["render",O]]),X=V,U=(0,a.pM)({name:l.iP,components:{TransferSendBase:c.A},props:c.g,setup:function(e){var t=(0,u.ZN)(),n=t.marketData,r=(0,u.ty)(),c=r.balance,d=(0,s.KR)(),v=(0,s.KR)(l.x0.form),p=(0,s.KR)(!1),m=(0,s.KR)({addresses:e.address?[e.address]:[],amount:e.amount,payload:e.payload,selectedAsset:i.C.getAdapter(l.yv.bitcoin).getDefaultCoin(n.value,+c.value)});function f(){d.value.submit()}function b(){v.value=l.x0.review}function A(){p.value=!1,v.value=l.x0.form}var g=(0,o.A)((0,o.A)({},l.x0.form,{component:X,onSuccess:b}),l.x0.review,{component:C,onSuccess:e.resolve}),y=(0,a.EW)((function(){return g[v.value]}));return{TRANSFER_SEND_STEPS:l.x0,PROTOCOLS:l.yv,currentRenderedComponent:d,steps:g,currentStep:v,error:p,transferData:m,currentStepConfig:y,proceedToNextStep:f,editTransfer:A}}}),j=(0,k.A)(U,[["render",r]]),K=j},52036:(e,t,n)=>{n.d(t,{A:()=>x});n(28706);var a=n(20641),r=n(90033),o={class:"transfer-review-base"},s={key:0},l={key:0};function i(e,t,n,i,u,c){var d,v,p,m,f,b=(0,a.g2)("ModalHeader"),A=(0,a.g2)("AvatarWithChainName"),g=(0,a.g2)("DetailsItem"),y=(0,a.g2)("TokenAmount"),h=(0,a.g2)("PayloadDetails"),S=(0,a.g2)("Loader");return(0,a.uX)(),(0,a.CE)("div",o,[(0,a.bF)(b,{title:e.title,subtitle:e.withoutSubtitle?null:e.subtitle,"no-padding":e.noHeaderPadding},{title:(0,a.k6)((function(){return[e.$slots.title?((0,a.uX)(),(0,a.CE)("div",s,[(0,a.RG)(e.$slots,"title",{},void 0,!0)])):(0,a.Q3)("",!0)]})),_:3},8,["title","subtitle","no-padding"]),(0,a.RG)(e.$slots,"subheader",{},void 0,!0),(0,a.bF)(g,{label:e.senderLabel,class:"sending-address","data-cy":"review-sender"},{value:(0,a.k6)((function(){return[(0,a.bF)(A,{address:e.activeAccount.address,protocol:e.protocol},null,8,["address","protocol"])]})),_:1},8,["label"]),e.$slots.recipient?((0,a.uX)(),(0,a.CE)("div",l,[(0,a.RG)(e.$slots,"recipient",{},void 0,!0)])):((0,a.uX)(),(0,a.Wv)(g,{key:1,class:(0,r.C4)(["details-item receiving-addresses",{"multiple-addresses":(null===(d=e.transferData.addresses)||void 0===d?void 0:d.length)>1}]),"data-cy":"review-recipient",expandable:(null===(v=e.transferData.addresses)||void 0===v?void 0:v.length)>1,label:"".concat(e.$t("pages.send.show")," ").concat(null===(p=e.transferData.addresses)||void 0===p?void 0:p.length," ").concat(e.$t("pages.send.recipients")),"expanded-label":(null===(m=e.transferData.addresses)||void 0===m?void 0:m.length)>1?"".concat(e.$t("pages.send.hide")," ").concat(null===(f=e.transferData.addresses)||void 0===f?void 0:f.length," ").concat(e.$t("pages.send.recipients")):e.$t("pages.send.recipient")},{value:(0,a.k6)((function(){return[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.transferData.addresses,(function(t){return(0,a.uX)(),(0,a.CE)("div",{key:t,class:"receiving-address"},[(0,a.bF)(A,{address:t,name:e.isNameValid(t)?t:void 0,protocol:e.protocol},null,8,["address","name","protocol"])])})),128))]})),_:1},8,["class","expandable","label","expanded-label"])),(0,a.bF)(g,{label:e.amountLabel,class:"details-item"},{value:(0,a.k6)((function(){var t;return[(0,a.bF)(y,{amount:+e.transferData.amount,symbol:e.tokenSymbol,protocol:e.protocol,"hide-fiat":!e.showFiat,price:null===(t=e.transferData.selectedAsset)||void 0===t?void 0:t.price,"data-cy":"review-amount"},null,8,["amount","symbol","protocol","hide-fiat","price"])]})),_:1},8,["label"]),e.recipientsCount>1?((0,a.uX)(),(0,a.Wv)(g,{key:2,label:e.multipleAmountLabel,class:"details-item"},{value:(0,a.k6)((function(){var t;return[(0,a.bF)(y,{amount:e.multipleAmount,symbol:e.tokenSymbol,protocol:e.protocol,"hide-fiat":!e.showFiat,price:null===(t=e.transferData.selectedAsset)||void 0===t?void 0:t.price,"data-cy":"review-amount"},null,8,["amount","symbol","protocol","hide-fiat","price"])]})),_:1},8,["label"])):(0,a.Q3)("",!0),(0,a.RG)(e.$slots,"additional-fee",{},void 0,!0),(0,a.bF)(g,{class:"details-item",label:e.feeLabel},{value:(0,a.k6)((function(){return[(0,a.bF)(y,{amount:+e.transferData.fee,symbol:e.baseTokenSymbol,protocol:e.protocol,"high-precision":"","data-cy":"review-fee"},null,8,["amount","symbol","protocol"])]})),_:1},8,["label"]),(0,a.RG)(e.$slots,"total",{},void 0,!0),(0,a.bF)(h,{class:"details-item","data-cy":"review-payload",payload:e.transferData.payload},null,8,["payload"]),e.loading?((0,a.uX)(),(0,a.Wv)(S,{key:3})):(0,a.Q3)("",!0)])}var u=n(64224),c=n(64101),d=n(95891),v=n(2205),p=n(90863),m=n(18494),f=n(24977),b=n(22915),A=n(40919),g=n(60447);const y=(0,a.pM)({name:"TransferReviewBase",components:{PayloadDetails:g.A,ModalHeader:A.A,AvatarWithChainName:b.A,DetailsItem:m.A,Loader:p.A,TokenAmount:f.A},props:{title:{type:String,default:(0,v.tg)("pages.send.reviewtx")},subtitle:{type:String,default:(0,v.tg)("pages.send.checkalert")},senderLabel:{type:String,default:(0,v.tg)("pages.send.sender")},amountLabel:{type:String,default:(0,v.tg)("common.amount")},multipleAmountLabel:{type:String,default:(0,v.tg)("pages.send.multipleAccountLabel")},feeLabel:{type:String,default:(0,v.tg)("transaction.fee")},baseTokenSymbol:{type:String,required:!0},transferData:{type:Object,required:!0},protocol:{type:String,required:!0},recipientAddress:{type:String,default:null},noHeaderPadding:Boolean,withoutSubtitle:Boolean,loading:Boolean,showFiat:Boolean},setup:function(e){var t=(0,c.oV)(),n=t.activeAccount,r=(0,a.EW)((function(){return e.recipientAddress&&(0,u.wJ)(e.recipientAddress)})),o=(0,a.EW)((function(){var t;return(null===(t=e.transferData.selectedAsset)||void 0===t?void 0:t.symbol)||"-"})),s=(0,a.EW)((function(){var t;return(null===(t=e.transferData.addresses)||void 0===t?void 0:t.length)||1})),l=(0,a.EW)((function(){return s.value>1&&e.transferData.amount?+e.transferData.amount*s.value:0}));return{AE_CONTRACT_ID:d.cK,isRecipientName:r,tokenSymbol:o,activeAccount:n,recipientsCount:s,multipleAmount:l,isNameValid:u.wJ}}});var h=n(66262);const S=(0,h.A)(y,[["render",i],["__scopeId","data-v-433a39e4"]]),x=S},62559:(e,t,n)=>{n.d(t,{A:()=>k});var a=n(20641),r={class:"transfer-send-recipient"},o={class:"buttons"},s={key:0,class:"status"};function l(e,t,n,l,i,u){var c=(0,a.g2)("BtnIcon"),d=(0,a.g2)("FormAccountInput"),v=(0,a.g2)("UrlStatus");return(0,a.uX)(),(0,a.CE)("div",r,[(0,a.bF)(d,{"v-model":e.modelValue,"model-value":e.modelValue,name:"addresses","data-cy":"address","show-help":"","show-message-help":"","is-recipient":"","single-default-format":1===e.maxRecipients,"is-tip-url-enabled":e.isUrlTippingEnabled,protocol:e.protocol,label:e.$t("modals.send.recipientLabel"),placeholder:e.placeholder,message:e.addressMessage,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.$emit("update:modelValue",t)}),onHelp:t[3]||(t[3]=function(t){return e.showRecipientHelp()}),onBlur:t[4]||(t[4]=function(t){return e.handleBlur(t,!0)})},{"label-after":(0,a.k6)((function(){return[(0,a.Lk)("div",o,[(0,a.bF)(c,{icon:e.AddressBookIcon,"data-cy":"address-book-button",onClick:t[0]||(t[0]=function(t){return e.selectFromAddressBook()})},null,8,["icon"]),(0,a.bF)(c,{icon:e.QrScanIcon,"data-cy":"scan-button",onClick:t[1]||(t[1]=function(t){return e.$emit("openQrModal")})},null,8,["icon"])])]})),_:1},8,["v-model","model-value","single-default-format","is-tip-url-enabled","protocol","label","placeholder","message"]),e.isTipUrl?((0,a.uX)(),(0,a.CE)("div",s,[(0,a.bF)(v,{status:e.urlStatus},null,8,["status"])])):(0,a.Q3)("",!0)])}var i=n(34916),u=n(70068),c=(n(16280),n(76918),n(2892),n(26099),n(81268)),d=n(96881),v=n(18743),p=n(64101),m=n(76329),f=n(15462),b=n(96065),A=n(5402),g=n(13039),y=n(18711),h=function(e,t,n,a){function r(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function s(e){try{i(a.next(e))}catch(t){o(t)}}function l(e){try{i(a["throw"](e))}catch(t){o(t)}}function i(e){e.done?n(e.value):r(e.value).then(s,l)}i((a=a.apply(e,t||[])).next())}))};const S=(0,a.pM)({components:{FormAccountInput:y.A,UrlStatus:f.A,BtnIcon:b.A},props:{isUrlTippingEnabled:Boolean,isTipUrl:Boolean,maxRecipients:{type:Number,default:null},modelValue:{type:Array,default:function(){return[]}},placeholder:{type:String,default:""},protocol:{type:String,required:!0},validationRules:{type:Object,default:function(){return{}}},errors:{type:Object,required:!0}},emits:["openQrModal","update:modelValue"],setup:function(e,t){var n=t.emit,r=(0,a.EW)((function(){return e.protocol===v.yv.aeternity})),o=(0,p.U8)(),s=o.openModal,l=(0,p.oV)(),f=l.activeAccount,b=(0,c.Mt)("addresses",Object.assign(Object.assign(Object.assign({required:!0},e.maxRecipients?{max_recipients:e.maxRecipients}:{}),e.validationRules),{address_not_same_as:[f.value.address,e.protocol]}),{bails:!1}),y=b.value,S=b.handleBlur,x=(0,m.NC)({ensureFetchedOnInit:r.value}),w=x.getTippingUrlStatus,k=(0,a.EW)((function(){var t;return w(null===(t=e.modelValue)||void 0===t?void 0:t[0])})),T=(0,a.EW)((function(){var t=(0,d.sY)(e.errors.addresses);if("error"===t.status)return t;if(e.isTipUrl)switch(k.value){case"verified":return{status:"success",text:"",hideMessage:!0};case"not-secure":case"not-verified":return{status:"warning",text:"",hideMessage:!0};case"blacklisted":return{status:"error",text:"",hideMessage:!0};default:throw new Error("Unknown url status: ".concat(k.value))}return t}));function C(){s(v.R$,{protocol:e.protocol})}function E(){return h(this,void 0,void 0,(0,i.A)().mark((function t(){var a;return(0,i.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s(v.tA,{preSelectedAddresses:e.modelValue,allowMultiple:e.maxRecipients>1});case 2:a=t.sent,a&&n("update:modelValue",(0,u.A)(a));case 4:case"end":return t.stop()}}),t)})))}return(0,a.wB)((function(){return e.modelValue}),(function(e){y.value=e}),{immediate:!!e.modelValue.length}),{QrScanIcon:A.A,AddressBookIcon:g.A,urlStatus:k,activeAccount:f,addressMessage:T,handleBlur:S,showRecipientHelp:C,selectFromAddressBook:E}}});var x=n(66262);const w=(0,x.A)(S,[["render",l],["__scopeId","data-v-7aa56c82"]]),k=w},81282:(e,t,n)=>{n.d(t,{A:()=>g,g:()=>m});var a=n(20641),r=n(53751),o={class:"relative"};function s(e,t,n,s,l,i){var u=(0,a.g2)("BtnMain"),c=(0,a.g2)("Modal");return(0,a.uX)(),(0,a.Wv)(c,{class:"transfer-send-base","has-close-button":"","from-bottom":"","no-padding-bottom":e.currentStep===e.TRANSFER_SEND_STEPS.form,onClose:t[2]||(t[2]=function(t){return e.$emit("close")})},{footer:(0,a.k6)((function(){return[e.showEditButton?((0,a.uX)(),(0,a.Wv)(u,{key:0,variant:"muted",text:e.$t("common.edit"),class:"button-action-secondary","data-cy":"edit",onClick:t[0]||(t[0]=function(t){return e.$emit("step-prev")})},null,8,["text"])):(0,a.Q3)("",!0),(0,a.bF)(u,{class:"button-action-primary",disabled:!e.isOnline||e.sendingDisabled,icon:e.primaryButtonIcon,text:e.primaryButtonText,"data-cy":"next-step-button",onClick:t[1]||(t[1]=function(t){return e.$emit("step-next")})},null,8,["disabled","icon","text"])]})),default:(0,a.k6)((function(){return[(0,a.Lk)("div",o,[(0,a.bF)(r.eB,{name:"fade-between"},{default:(0,a.k6)((function(){return[(0,a.RG)(e.$slots,"content",{},void 0,!0)]})),_:3})])]})),_:3},8,["no-padding-bottom"])}n(74423),n(21699);var l=n(73834),i=n(18743),u=n(64101),c=n(53908),d=n(5402),v=n(2677),p=n(55312),m={resolve:{type:Function,default:function(){return null}},address:{type:String,default:void 0},amount:{type:String,default:""},payload:{type:String,default:""}};const f=(0,a.pM)({name:"TransferSendBase",components:{Modal:v.A,BtnMain:p.A},props:{customPrimaryButtonText:{type:String,default:""},currentStep:{type:String,required:!0},sendingDisabled:Boolean,hideArrowSendIcon:Boolean},emits:["close","step-prev","step-next"],setup:function(e){var t=(0,l.s9)(),n=t.t,r=(0,u.w5)(),o=r.isOnline,s=(0,u.oV)(),v=s.isActiveAccountAirGap,p=(0,a.EW)((function(){return[i.x0.review,i.x0.reviewTip,i.x0.airGapSign].includes(e.currentStep)})),m=(0,a.EW)((function(){return[i.x0.review,i.x0.airGapSign].includes(e.currentStep)})),f=(0,a.EW)((function(){return e.currentStep===i.x0.review&&v.value})),b=(0,a.EW)((function(){return e.customPrimaryButtonText?e.customPrimaryButtonText:m.value?n("common.send"):n("common.next")})),A=(0,a.EW)((function(){return!m.value||f.value||e.hideArrowSendIcon?null:c.A}));return{isOnline:o,primaryButtonText:b,primaryButtonIcon:A,showEditButton:p,showSendButton:m,ArrowSendIcon:c.A,QrScanIcon:d.A,TRANSFER_SEND_STEPS:i.x0}}});var b=n(66262);const A=(0,b.A)(f,[["render",s],["__scopeId","data-v-bf95a638"]]),g=A},90415:(e,t,n)=>{n.d(t,{A:()=>f});var a=n(20641),r=n(90033),o={class:"transaction-speed-picker"},s={class:"radio-wrapper"},l={key:0,class:"completion-time"};function i(e,t,n,i,u,c){var d=(0,a.g2)("RadioButton");return(0,a.uX)(),(0,a.CE)("div",o,[(0,a.Lk)("div",s,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.feeList,(function(t,n){return(0,a.uX)(),(0,a.Wv)(d,{key:n,value:e.modelValue===n,label:t.label,"has-label-effect":"",onInput:function(t){return e.handleInput(n)}},null,8,["value","label","onInput"])})),128))]),e.UNFINISHED_FEATURES?((0,a.uX)(),(0,a.CE)("p",l,(0,r.v_)(e.$t("modals.send.transactionWillBeCompleted",{time:e.secondsToRelativeTime(e.feeList[e.modelValue].time,!0)})),1)):(0,a.Q3)("",!0)])}n(2892);var u=n(96881),c=n(18743),d=n(36231);const v=(0,a.pM)({components:{RadioButton:d.A},props:{feeList:{type:Array,required:!0,validate:function(e){return 3===e.length}},modelValue:{type:Number,default:1}},emits:["update:modelValue"],setup:function(e,t){var n=t.emit;function a(e){n("update:modelValue",e)}return{UNFINISHED_FEATURES:c.s4,secondsToRelativeTime:u.Aq,handleInput:a}}});var p=n(66262);const m=(0,p.A)(v,[["render",i],["__scopeId","data-v-f11f50e0"]]),f=m}}]);