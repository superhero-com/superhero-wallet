"use strict";(self["webpackChunksuperhero_wallet"]=self["webpackChunksuperhero_wallet"]||[]).push([[6078],{3920:function(t,e,n){var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o.apply(this,arguments)},i=this&&this.__awaiter||function(t,e,n,r){function o(t){return t instanceof n?t:new n(function(e){e(t)})}return new(n||(n=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r["throw"](t))}catch(e){i(e)}}function c(t){t.done?n(t.value):o(t.value).then(a,s)}c((r=r.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(o=2&i[0]?r["return"]:i[0]?r["throw"]||((o=r["return"])&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(o=a.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var s=n(98449),c=n(21455),u=n(52916),l=n(74084),f=n(37565),p=n(43782),d=n(99055),h=function(t){function e(e){var n=t.call(this)||this;return n.options=e,n.isSubProtocol=!0,n.subProtocolType=u.SubProtocolType.TOKEN,n.defaultSourceAddress="tz1Mj7RzPmMAqDUNFBn5t5VbXmWW4cSUAdtT",n.contractAddress=n.options.config.contractAddress,n.symbol=n.options.config.symbol,n.name=n.options.config.name,n.marketSymbol=n.options.config.marketSymbol,n.identifier=n.options.config.identifier,n.feeDefaults=n.options.config.feeDefaults,n.decimals=n.options.config.decimals,n.contract=new l.TezosContract(n.options.config.contractAddress,n.options.network.rpcUrl,n.options.network.extras.conseilUrl,n.options.network.extras.conseilNetwork,n.options.network.extras.conseilApiKey),n}return r(e,t),e.prototype.bigMapValue=function(t,e,n){return void 0===e&&(e=!1),i(this,void 0,void 0,function(){var r;return a(this,function(o){switch(o.label){case 0:return[4,this.contract.bigMapValues({bigMapID:n,predicates:[{field:e?"key_hash":"key",operation:"eq",set:[t]}]})];case 1:return r=o.sent(),[2,r.length>0?r[0].value:null]}})})},e.prototype.estimateMaxTransactionValueFromPublicKey=function(t,e,n){return i(this,void 0,void 0,function(){return a(this,function(e){return[2,this.getBalanceOfPublicKey(t)]})})},e.prototype.getTransactionsFromPublicKey=function(t,e,n){return i(this,void 0,void 0,function(){var r;return a(this,function(o){switch(o.label){case 0:return[4,this.getAddressesFromPublicKey(t)];case 1:return r=o.sent(),[2,this.getTransactionsFromAddresses(r,e,n)]}})})},e.prototype.getTransactionsFromAddresses=function(t,e,n){return i(this,void 0,void 0,function(){var r,o,i,c=this;return a(this,function(a){switch(a.label){case 0:return[4,Promise.all(t.map(function(t){var r={predicates:[{field:"parameters",operation:"like",set:[t],inverse:!1},{field:"parameters_entrypoints",operation:"eq",set:["transfer"],inverse:!1},{field:"kind",operation:"eq",set:["transaction"],inverse:!1},{field:"destination",operation:"eq",set:[c.contractAddress],inverse:!1}],orderBy:[{field:"timestamp",direction:"desc"}],limit:e};return n&&n.lastBlockLevel&&r.predicates.push({field:"block_level",operation:"lt",set:[n.lastBlockLevel.toString()],inverse:!1}),s.default.post(c.baseApiUrl+"/v2/data/tezos/"+c.baseApiNetwork+"/operations",r,{headers:c.headers}).then(function(t){return t.data}).catch(function(){return[]})}))];case 1:return r=a.sent(),o=r.length>0?r[r.length-1].block_level:0,i=r.reduce(function(t,e){return t.concat(e)}).map(function(e){return c.transactionToAirGapTransactions(e,t)}).reduce(function(t,e){return t.concat(e)},[]),[2,{transactions:i,cursor:{lastBlockLevel:o}}]}})})},e.prototype.getTransactions=function(t,e){return i(this,void 0,void 0,function(){var n,r,o,i,c=this;return a(this,function(a){switch(a.label){case 0:return n={predicates:[{field:"parameters",operation:"like",set:['"transfer"'],inverse:!1},{field:"kind",operation:"eq",set:["transaction"],inverse:!1},{field:"destination",operation:"eq",set:[this.contractAddress],inverse:!1}],orderBy:[{field:"block_level",direction:"desc"}],limit:t},void 0!==e&&n.predicates.push({field:"block_level",operation:"lt",set:[e.lastBlockLevel],inverse:!1}),[4,s.default.post(this.baseApiUrl+"/v2/data/tezos/"+this.baseApiNetwork+"/operations",n,{headers:this.headers})];case 1:return r=a.sent(),o=r.data.map(function(t){return c.transactionToAirGapTransactions(t)}).reduce(function(t,e){return t.concat(e)},[]),i=r.data.length>0?r.data[r.data.length-1].block_level:0,[2,{transactions:o,cursor:{lastBlockLevel:i}}]}})})},e.prototype.normalizeTransactionParameters=function(t,e){return i(this,void 0,void 0,function(){var n;return a(this,function(r){if(n=this.parseParameters(t),!(n instanceof Object&&"value"in n)&&!d.isMichelineNode(n))throw new Error("Invalid parameters.");return[2,this.contract.normalizeContractCallParameters(n,e)]})})},e.prototype.getTransactionOperationDetails=function(t){var e;return i(this,void 0,void 0,function(){var n;return a(this,function(r){n=[];try{n=t.parameters?(e=this.transactionDetailsFromParameters(t.parameters),null!==e&&void 0!==e?e:[]):[]}catch(i){}return 0===n.length&&n.push({}),[2,n.map(function(e){return o({from:[t.source],amount:t.amount,to:[t.destination]},e)})]})})},e.prototype.parseParameters=function(t){var e="Unparsable code: ";return t.startsWith(e)&&(t=t.slice(e.length)),JSON.parse(t)},e.prototype.transactionToAirGapTransactions=function(t,e){var n,r=this,i=(n=t.parameters_micheline,null!==n&&void 0!==n?n:t.parameters),a=this.parseParameters(i);if(!d.isMichelineNode(a))throw new Error("Transaction parameters are invalid.");var s={entrypoint:t.parameters_entrypoints,value:a},u=this.transactionDetailsFromParameters(s);return u.map(function(n){var i,a=!(void 0===e||!n.to||1!==n.to.length)&&-1!==e.indexOf(n.to[0]);return o({amount:new c.default(0).toFixed(),fee:new c.default((i=t.fee,null!==i&&void 0!==i?i:0)).toFixed(),from:[],isInbound:a,protocolIdentifier:r.identifier,network:r.options.network,to:[],hash:t.operation_group_hash,timestamp:t.timestamp/1e3,blockHeight:t.block_level,status:t.status},n)})},e.prototype.runContractCall=function(t,e){return i(this,void 0,void 0,function(){var n,r,o,i,u,l,f,p;return a(this,function(a){switch(a.label){case 0:return[4,Promise.all([s.default.get(this.url("/chains/main/blocks/head/context/contracts/"+e+"/counter")),s.default.get(this.url("/chains/main/blocks/head/"))])];case 1:n=a.sent(),r=new c.default(n[0].data).plus(1),o=n[1].data.hash,i=n[1].data.chain_id,u=this.prepareMockContractCall(t,i,o,r,e,this.contractAddress),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,s.default.post(this.url("/chains/main/blocks/head/helpers/scripts/run_operation"),u,{headers:{"Content-Type":"application/json"}})];case 3:if(l=a.sent(),f=l.data.contents[0].metadata,void 0!==f.internal_operation_results&&"applied"===f.operation_result.status)return[2,f.internal_operation_results[0].parameters.value];throw new Error(f.operation_result.errors[0].id);case 4:throw p=a.sent(),console.error(p),p;case 5:return[2]}})})},e.prototype.prepareContractCall=function(t,e,n){return i(this,void 0,void 0,function(){var r,o,i,s,c=this;return a(this,function(a){switch(a.label){case 0:r=t.map(function(t){return{kind:p.TezosOperationType.TRANSACTION,fee:e,amount:"0",destination:c.contractAddress,parameters:t.toJSON()}}),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,this.prepareOperations(n,r,!1)];case 2:return o=a.sent(),[4,this.forgeTezosOperation(o)];case 3:return i=a.sent(),[2,{binaryTransaction:i}];case 4:throw s=a.sent(),console.error(s.message),new Error("Forging Tezos TX failed.");case 5:return[2]}})})},e.prototype.requireSource=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var o=null!==t&&void 0!==t?t:e;return void 0===o||n.some(function(t){return o.toLowerCase().startsWith(t.toLowerCase())})?this.defaultSourceAddress:o},e.prototype.prepareMockContractCall=function(t,e,n,r,o,i,a){return void 0===a&&(a="0"),{chain_id:e,operation:{branch:n,signature:"sigUHx32f9wesZ1n2BWpixXz4AQaZggEtchaQNHYGRCoWNAXx45WGW2ua3apUUUAGMLPwAU41QoaFCzVSL61VaessLg4YbbP",contents:[{kind:p.TezosOperationType.TRANSACTION,counter:r.toFixed(),amount:"0",source:o,destination:i,fee:a,gas_limit:"400000",storage_limit:"60000",parameters:t.toJSON()}]}}},e.prototype.url=function(t){return""+this.jsonRPCAPI+t},e}(f.TezosProtocol);e.TezosFAProtocol=h},6220:(t,e,n)=>{var r=n(48287)["Buffer"];Object.defineProperty(e,"__esModule",{value:!0});var o=n(49312),i=n(85858),a=n(67480),s=n(63568),c=n(29661),u=n(40431),l=n(7085),f=function(){function t(){}return t.parseAddress=function(t){var e="string"===typeof t?t:t.toString("hex");e.startsWith("0x")&&(e=e.slice(2));var n=this.splitAndReturnRest(e,2),r=n.result,o=n.rest,i=r;if("00"===i)return this.parseTzAddress(o);if("01"===i)return this.prefixAndBase58CheckEncode(o.slice(0,-2),this.tezosPrefixes.kt);throw new Error("address format not supported ("+e+")")},t.parseHex=function(e){var n;n="string"===typeof e?t.hexStringToArray(e):e;var r=n.shift();switch(r){case"07":var o=n.shift();if("07"===o)return t.parsePair(n);throw new Error("Prim type not supported");case"00":var i=[],a=void 0;do{if(a=n.shift(),void 0===a)break;i.push(a)}while(parseInt(a,16)>=127);return u.MichelsonInt.from(t.decodeSignedInt(i.join("")));case"01":var s=t.hexToLength(n.splice(0,4));return l.MichelsonString.from(t.hexToString(n.splice(0,s)));case"05":return t.parseHex(n);case"02":return t.parseList(n);case"0a":var f=t.hexToLength(n.splice(0,4));return c.MichelsonBytes.from(n.splice(0,f).join(""));default:throw new Error("Type not supported "+r)}},t.decodeSignedInt=function(t){for(var e=!(64&r.from(t.slice(0,2),"hex")[0]),n=r.from(t,"hex").map(function(t,e){return 0===e?63&t:127&t}),i=o.zero,a=n.length-1;a>=0;a--)i=0===a?i.or(n[a]):i.or(o(n[a]).shiftLeft(7*a-1));return e?i.toJSNumber():i.negate().toJSNumber()},t.hexStringToArray=function(t){t.startsWith("0x")&&(t=t.slice(2));var e=t.match(/.{2}/g);if(null===e)throw new Error("Cannot parse contract code");return e},t.parsePair=function(e){var n=t.parseHex(e),r=t.parseHex(e);return s.MichelsonPair.from([n,r])},t.parseList=function(e){var n=[],r=t.hexToLength(e.splice(0,4));if(r>0){var o=e.splice(0,r);while(o.length>0){var i=t.parseHex(o);n.push(i)}}return a.MichelsonList.from(n)},t.hexToString=function(t){return t.map(function(t){return String.fromCharCode(parseInt(t,16))}).join("")},t.hexToLength=function(t){var e=t.reduce(function(t,e){return"00"===e?t:""+t+e},"");return e.length>0?parseInt(e,16):0},t.splitAndReturnRest=function(t,e){var n=t.substr(0,e),r=t.substr(e,t.length-e);return{result:n,rest:r}},t.parseTzAddress=function(t){var e=this.splitAndReturnRest(t,2),n=e.result,r=e.rest,o=n;switch(o){case"00":return this.prefixAndBase58CheckEncode(r,this.tezosPrefixes.tz1);case"01":return this.prefixAndBase58CheckEncode(r,this.tezosPrefixes.tz2);case"02":return this.prefixAndBase58CheckEncode(r,this.tezosPrefixes.tz3);default:throw new Error("address format not supported ("+t+")")}},t.prefixAndBase58CheckEncode=function(t,e){var n=r.from(e).toString("hex");return i.encode(r.from(n+t,"hex"))},t.tezosPrefixes={tz1:r.from(new Uint8Array([6,161,159])),tz2:r.from(new Uint8Array([6,161,161])),tz3:r.from(new Uint8Array([6,161,164])),kt:r.from(new Uint8Array([2,90,121])),edpk:r.from(new Uint8Array([13,15,37,217])),edsk:r.from(new Uint8Array([43,246,78,7])),edsig:r.from(new Uint8Array([9,245,205,134,18])),branch:r.from(new Uint8Array([1,52]))},t}();e.TezosUtils=f},11433:function(t,e,n){var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(t,e,n,r){function o(t){return t instanceof n?t:new n(function(e){e(t)})}return new(n||(n=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r["throw"](t))}catch(e){i(e)}}function c(t){t.done?n(t.value):o(t.value).then(a,s)}c((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(o=2&i[0]?r["return"]:i[0]?r["throw"]||((o=r["return"])&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(o=a.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(86083),s=n(6220),c=n(21189),u=n(62644),l=function(t){function e(e){void 0===e&&(e=new u.TezosFAProtocolOptions(new a.TezosProtocolNetwork,new u.TezosStakerProtocolConfig));var n=t.call(this,e)||this;return n.options=e,n}return r(e,t),e.prototype.fetchTokenHolders=function(){return o(this,void 0,void 0,function(){var t;return i(this,function(e){switch(e.label){case 0:return[4,this.contract.bigMapValues()];case 1:return t=e.sent(),[2,t.map(function(t){return{address:s.TezosUtils.parseAddress(t.key.substring(2)),amount:null!==t.value?t.value:"0"}}).filter(function(t){return"0"!==t.amount})]}})})},e}(c.TezosFA1Protocol);e.TezosStaker=l},21189:function(t,e,n){var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o.apply(this,arguments)},i=this&&this.__awaiter||function(t,e,n,r){function o(t){return t instanceof n?t:new n(function(e){e(t)})}return new(n||(n=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r["throw"](t))}catch(e){i(e)}}function c(t){t.done?n(t.value):o(t.value).then(a,s)}c((r=r.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(o=2&i[0]?r["return"]:i[0]?r["throw"]||((o=r["return"])&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(o=a.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var s,c=n(21455),u=n(48191),l=n(37565),f=n(6220),p=n(43782),d=n(99055),h=n(3920),v=n(17286),y=n(63568),g=n(40431);(function(t){t["BALANCE"]="getBalance",t["TRANSFER"]="transfer",t["TOTAL_SUPPLY"]="getTotalSupply"})(s||(s={}));var w=function(t){function e(e){var n=t.call(this,e)||this;return n.defaultCallbackContractMap=new Map,n.defaultCallbackContractMap.set(l.TezosNetwork.MAINNET,"KT19ptNzn4MVAN45KUUNpyL5AdLVhujk815u"),n.defaultCallbackContractMap.set(l.TezosNetwork.DELPHINET,"KT1FEfp83DLZkY6sc4x78n4BQp8hRszHwGBk"),n}return r(e,t),e.prototype.getBalanceOfAddresses=function(t){return i(this,void 0,void 0,function(){var e,n,r,o,i;return a(this,function(a){switch(a.label){case 0:for(e=[],n=0,r=t;n<r.length;n++)o=r[n],e.push(this.getBalance(o,this.defaultSourceAddress));return[4,Promise.all(e)];case 1:return i=a.sent(),[2,i.reduce(function(t,e){return t.plus(new c.default(e))},new c.default(0)).toFixed()]}})})},e.prototype.estimateFeeDefaultsFromPublicKey=function(t,e,n,r){return i(this,void 0,void 0,function(){var o,i,s=this;return a(this,function(a){switch(a.label){case 0:if(e.length!==n.length)throw new Error("length of recipients and values does not match!");return[4,this.createTransferCalls(t,e,n,this.feeDefaults.medium,r)];case 1:return o=a.sent(),i=o.map(function(t){return{kind:p.TezosOperationType.TRANSACTION,amount:"0",destination:s.contractAddress,parameters:t.toJSON(),fee:"0"}}),[2,this.estimateFeeDefaultsForOperations(t,i)]}})})},e.prototype.prepareTransactionFromPublicKey=function(t,e,n,r,o){return i(this,void 0,void 0,function(){var i;return a(this,function(a){switch(a.label){case 0:return[4,this.createTransferCalls(t,e,n,r,o)];case 1:return i=a.sent(),[2,this.prepareContractCall(i,r,t)]}})})},e.prototype.transactionDetailsFromParameters=function(t){var e={extra:{type:t.entrypoint}};if(t.entrypoint!==s.TRANSFER)return console.warn("Only calls to the transfer entrypoint can be converted to IAirGapTransaction"),[e];try{var n=y.MichelsonPair.from(t.value,function(t){return v.MichelsonAddress.from(t,"from")},function(t){return y.MichelsonPair.from(t,function(t){return v.MichelsonAddress.from(t,"to")},function(t){return g.MichelsonInt.from(t,"value")})}).asRawValue();return this.isTransferRequest(n)?[o(o({},e),{amount:n.value.toFixed(),from:[u.isHex(n.from)?f.TezosUtils.parseAddress(n.from):n.from],to:[u.isHex(n.to)?f.TezosUtils.parseAddress(n.to):n.to]})]:[e]}catch(r){return[e]}},e.prototype.getBalance=function(t,e,n){return void 0===n&&(n=this.callbackContract()),i(this,void 0,void 0,function(){var r;return a(this,function(o){switch(o.label){case 0:return[4,this.contract.createContractCall(s.BALANCE,[{owner:t},n])];case 1:return r=o.sent(),[2,this.getContractCallIntResult(r,this.requireSource(e,t,"kt"))]}})})},e.prototype.getTotalSupply=function(t,e){return void 0===e&&(e=this.callbackContract()),i(this,void 0,void 0,function(){var n;return a(this,function(r){switch(r.label){case 0:return[4,this.contract.createContractCall(s.TOTAL_SUPPLY,[[],e])];case 1:return n=r.sent(),[2,this.getContractCallIntResult(n,this.requireSource(t))]}})})},e.prototype.transfer=function(t,e,n,r,o){return i(this,void 0,void 0,function(){var i;return a(this,function(a){switch(a.label){case 0:return[4,this.contract.createContractCall(s.TRANSFER,{from:t,to:e,value:new c.default(n).toNumber()})];case 1:return i=a.sent(),[2,this.prepareContractCall([i],r,o)]}})})},e.prototype.fetchTokenHolders=function(){return i(this,void 0,void 0,function(){return a(this,function(t){return[2,[]]})})},e.prototype.getContractCallIntResult=function(t,e){return i(this,void 0,void 0,function(){var n;return a(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.runContractCall(t,e)];case 1:return n=r.sent(),d.isMichelinePrimitive("int",n)?[2,n.int]:[3,3];case 2:return r.sent(),[3,3];case 3:return[2,"0"]}})})},e.prototype.createTransferCalls=function(t,e,n,r,o){return i(this,void 0,void 0,function(){var r,i,u,l,f,p;return a(this,function(a){switch(a.label){case 0:if(e.length!==n.length)throw new Error("length of recipients and values does not match!");return r=o&&void 0!==o.addressIndex?o.addressIndex:0,[4,this.getAddressesFromPublicKey(t)];case 1:if(i=a.sent(),!i[r])throw new Error("no kt-address with this index exists");u=i[r],l=[],f=0,a.label=2;case 2:return f<e.length?[4,this.contract.createContractCall(s.TRANSFER,{from:u,to:e[f],value:new c.default(n[f]).toNumber()})]:[3,5];case 3:p=a.sent(),l.push(p),a.label=4;case 4:return f++,[3,2];case 5:return[2,l]}})})},e.prototype.callbackContract=function(){var t;return t=this.defaultCallbackContractMap.get(this.options.network.extras.network),null!==t&&void 0!==t?t:""},e.prototype.isTransferRequest=function(t){var e=t;return e instanceof Object&&"string"===typeof e.from&&"string"===typeof e.to&&c.default.isBigNumber(e.value)},e}(h.TezosFAProtocol);e.TezosFA1Protocol=w},27534:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0});var r=n(32680),o=n(99055),i=function(){function t(t,e){this.name=t,this.type=e}return t.fromJSON=function(e){return Object.entries(e).filter(function(t){t[0];var e=t[1];return o.isMichelinePrimitiveApplication(e)}).map(function(e){var n=e[0],o=e[1],i=r.MichelsonTypeMeta.fromMichelineNode(o);return i?new t(n,i):void 0}).filter(function(t){return void 0!==t})},t}();e.TezosContractEntrypoint=i},35284:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.entrypoint=t,this.michelsonValue=e}return t.prototype.args=function(){var t;return null===(t=this.michelsonValue)||void 0===t?void 0:t.asRawValue()},t.prototype.toJSON=function(){return{entrypoint:this.entrypoint,value:this.michelsonValue?this.michelsonValue.toMichelineJSON():[]}},t}();e.TezosContractCall=n},35312:function(t,e,n){var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o.apply(this,arguments)},i=this&&this.__awaiter||function(t,e,n,r){function o(t){return t instanceof n?t:new n(function(e){e(t)})}return new(n||(n=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r["throw"](t))}catch(e){i(e)}}function c(t){t.done?n(t.value):o(t.value).then(a,s)}c((r=r.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(o=2&i[0]?r["return"]:i[0]?r["throw"]||((o=r["return"])&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(o=a.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var s,c=n(21455),u=n(48191),l=n(37565),f=n(6220),p=n(63568),d=n(17286),h=n(40431),v=n(7085),y=n(43782),g=n(99055),w=n(3920),b=n(67480);(function(t){t["BALANCE"]="balance_of",t["TRANSFER"]="transfer",t["UPDATE_OPERATORS"]="update_operators",t["TOKEN_METADATA_REGISTRY"]="token_metadata_registry",t["TOKEN_METADATA"]="token_metadata"})(s||(s={}));var m=function(t){function e(n){var r,o,i,a,c,u=t.call(this,n)||this;return u.tokenID=n.config.tokenID,u.tokenMetadataBigMapID=n.config.tokenMetadataBigMapID,u.tokenMetadataBigMapName=(a=n.config.tokenMetadataBigMapName,null!==a&&void 0!==a?a:e.DEFAULT_TOKEN_METADATA_BIG_MAP_NAME),u.tokenMedatadaBigMapValueRegex=(c=n.config.tokenMetadataBigMapRegex,null!==c&&void 0!==c?c:e.DEFAULT_TOKEN_METADATA_BIG_MAP_VALUE_REGEX),u.defaultCallbackContract=(r={},r[l.TezosNetwork.MAINNET]=(o={},o[s.BALANCE]="KT1LyHDYnML5eCuTEVCTynUpivwG6ns6khiG",o[s.TOKEN_METADATA_REGISTRY]="KT1L16VBmW8tkovhLmonhfvf6dtTZya6k6af",o),r[l.TezosNetwork.DELPHINET]=(i={},i[s.BALANCE]="KT1LQRsAjvUmP4PQi5WXGFyGWPWwbevCLuiw",i[s.TOKEN_METADATA_REGISTRY]="KT1VnbvGMNg21xGDqJtW2UkzHyyAB21GV4oy",i),r),u}return r(e,t),e.prototype.getBalanceOfAddresses=function(t){return i(this,void 0,void 0,function(){var e,n;return a(this,function(r){switch(r.label){case 0:if(e=this.tokenID,void 0===e)throw new Error("Can't check the balance, no tokenID has been provided.");return[4,this.balanceOf(t.map(function(t){return{address:t,tokenID:e}},this.defaultSourceAddress))];case 1:return n=r.sent(),[2,n.reduce(function(t,e){return t.plus(e.amount)},new c.default(0)).toFixed()]}})})},e.prototype.estimateFeeDefaultsFromPublicKey=function(t,e,n,r){return i(this,void 0,void 0,function(){var o,i;return a(this,function(a){switch(a.label){case 0:if(e.length!==n.length)throw new Error("length of recipients and values does not match!");return[4,this.createTransferCall(t,e,n,this.feeDefaults.medium,r)];case 1:return o=a.sent(),i={kind:y.TezosOperationType.TRANSACTION,amount:"0",destination:this.contractAddress,parameters:o.toJSON(),fee:"0"},[2,this.estimateFeeDefaultsForOperations(t,[i])]}})})},e.prototype.prepareTransactionFromPublicKey=function(t,e,n,r,o){return i(this,void 0,void 0,function(){var i;return a(this,function(a){switch(a.label){case 0:return[4,this.createTransferCall(t,e,n,r,o)];case 1:return i=a.sent(),[2,this.prepareContractCall([i],r,t)]}})})},e.prototype.transactionDetailsFromParameters=function(t){var e=this,n={extra:{type:t.entrypoint}};if(t.entrypoint!==s.TRANSFER)return console.warn("Only calls to the transfer entrypoint can be converted to IAirGapTransaction"),[n];try{var r=b.MichelsonList.from(t.value,function(t){return p.MichelsonPair.from(t,function(t){return d.MichelsonAddress.from(t,"from_")},function(t){return b.MichelsonList.from(t,function(t){return p.MichelsonPair.from(t,function(t){return d.MichelsonAddress.from(t,"to_")},function(t){return p.MichelsonPair.from(t,function(t){return h.MichelsonInt.from(t,"token_id")},function(t){return h.MichelsonInt.from(t,"amount")})})},"txs")})}).asRawValue();return Array.isArray(r)?r.map(function(r){if(!e.isTransferRequest(r))return[];var i=u.isHex(r.from_)?f.TezosUtils.parseAddress(r.from_):r.from_,a=r.txs.map(function(t){var e=u.isHex(t.to_)?f.TezosUtils.parseAddress(t.to_):t.to_;return[e,t.token_id,t.amount]});return a.map(function(r){var a=r[0],s=r[1],c=r[2];return o(o({},n),{amount:c.toFixed(),from:[i],to:[a],extra:{type:t.entrypoint,assetID:void 0!==e.tokenID&&s.eq(e.tokenID)?void 0:s.toString()}})})}).reduce(function(t,e){return t.concat(e)},[]):[n]}catch(i){return[n]}},e.prototype.balanceOf=function(t,e,n){return void 0===n&&(n=this.callbackContract(s.BALANCE)),i(this,void 0,void 0,function(){var r,o;return a(this,function(i){switch(i.label){case 0:return[4,this.contract.createContractCall(s.BALANCE,{requests:t.map(function(t){return{owner:t.address,token_id:t.tokenID}}),callback:n})];case 1:return r=i.sent(),[4,this.runContractCall(r,this.requireSource(e))];case 2:return o=i.sent(),g.isMichelineSequence(o)?[2,o.map(function(t){try{var e=p.MichelsonPair.from(t,function(t){return p.MichelsonPair.from(t,d.MichelsonAddress.from,h.MichelsonInt.from)},h.MichelsonInt.from),n=p.MichelsonPair.from(e.first.get()),r=d.MichelsonAddress.from(n.first.get()),o=h.MichelsonInt.from(n.second.get()),i=h.MichelsonInt.from(e.second.get());return{address:r.address instanceof v.MichelsonString?r.address.value:f.TezosUtils.parseAddress(r.address.value),tokenID:o.value.toNumber(),amount:i.value.toFixed()}}catch(a){return void console.warn(a)}}).filter(function(t){return void 0!==t})]:[2,[]]}})})},e.prototype.transfer=function(t,e,n){return i(this,void 0,void 0,function(){var r;return a(this,function(o){switch(o.label){case 0:return[4,this.contract.createContractCall(s.TRANSFER,t.map(function(t){return{from_:t.from,txs:t.txs.map(function(t){return{to_:t.to,token_id:t.tokenID,amount:t.amount}})}}))];case 1:return r=o.sent(),[2,this.prepareContractCall([r],e,n)]}})})},e.prototype.updateOperators=function(t,e,n){return i(this,void 0,void 0,function(){var r;return a(this,function(o){switch(o.label){case 0:return[4,this.contract.createContractCall(s.UPDATE_OPERATORS,t.map(function(t){var e,n=(e={},e[t.operation+"_operator"]={owner:t.owner,operator:t.operator,token_id:t.tokenId},e);return["add"===t.operation?"Left":"Right",n]}))];case 1:return r=o.sent(),[2,this.prepareContractCall([r],e,n)]}})})},e.prototype.tokenMetadataRegistry=function(t,e){return void 0===e&&(e=this.callbackContract(s.TOKEN_METADATA_REGISTRY)),i(this,void 0,void 0,function(){var n,r;return a(this,function(o){switch(o.label){case 0:return[4,this.contract.createContractCall(s.TOKEN_METADATA_REGISTRY,e)];case 1:return n=o.sent(),[4,this.runContractCall(n,this.requireSource(t)).catch(function(){return[]})];case 2:return r=o.sent(),g.isMichelinePrimitive("string",r)?[2,r.string]:g.isMichelinePrimitive("bytes",r)?[2,f.TezosUtils.parseAddress(r.bytes)]:[2,""]}})})},e.prototype.tokenMetadata=function(t,e,n,r){return i(this,void 0,void 0,function(){var o;return a(this,function(i){switch(i.label){case 0:return[4,this.contract.createContractCall(s.TOKEN_METADATA,{token_ids:t,handler:e})];case 1:return o=i.sent(),[2,this.prepareContractCall([o],n,r)]}})})},e.prototype.getTokenMetadata=function(t){return i(this,void 0,void 0,function(){var e,n=this;return a(this,function(r){switch(r.label){case 0:return[4,this.contract.bigMapValues({bigMapID:this.tokenMetadataBigMapID,predicates:t?[{field:"key",operation:"in",set:t}]:void 0})];case 1:return e=r.sent(),[2,e.map(function(t){var e=t.value?n.tokenMedatadaBigMapValueRegex.exec(t.value):null;return e&&n.isTokenMetadata(e.groups)?{tokenID:new c.default(e.groups.tokenID).toNumber(),symbol:e.groups.symbol,name:e.groups.name,decimals:new c.default(e.groups.decimals).toNumber(),extras:e.groups.extras}:null}).filter(function(t){return null!==t})]}})})},e.prototype.fetchTokenHolders=function(t){return i(this,void 0,void 0,function(){return a(this,function(t){return[2,[]]})})},e.prototype.createTransferCall=function(t,e,n,r,o){return i(this,void 0,void 0,function(){var r,i,c,u,l,f;return a(this,function(a){switch(a.label){case 0:if(e.length!==n.length)throw new Error("length of recipients and values does not match!");return r=o&&void 0!==o.addressIndex?o.addressIndex:0,i=o&&void 0!==o.tokenID?o.tokenID:0,[4,this.getAddressesFromPublicKey(t)];case 1:if(c=a.sent(),!c[r])throw new Error("no kt-address with this index exists");return u=c[r],l=e.map(function(t,e){return[t,n[e]]}),[4,this.contract.createContractCall(s.TRANSFER,[{from_:u,txs:l.map(function(t){var e=t[0],n=t[1];return{to_:e,token_id:i,amount:n}})}])];case 2:return f=a.sent(),[2,f]}})})},e.prototype.callbackContract=function(t){var e=this.defaultCallbackContract[this.options.network.extras.network],n=e?e[t]:void 0;return null!==n&&void 0!==n?n:""},e.prototype.isTransferRequest=function(t){var e=t;return e instanceof Object&&"string"===typeof e.from_&&Array.isArray(e.txs)&&e.txs.every(function(t){return t instanceof Object&&"string"===typeof t.to_&&c.default.isBigNumber(t.token_id)&&c.default.isBigNumber(t.amount)})},e.prototype.isTokenMetadata=function(t){return"object"===typeof t&&null!==t&&"tokenID"in t&&"symbol"in t&&"name"in t&&"decimals"in t},e.DEFAULT_TOKEN_METADATA_BIG_MAP_NAME="token_metadata",e.DEFAULT_TOKEN_METADATA_BIG_MAP_VALUE_REGEX=/Pair\s\(Pair\s(?<tokenID>\d+)\s\(Pair\s\"(?<symbol>\w*)\"\s\(Pair\s\"(?<name>\w*)\"\s\(Pair\s(?<decimals>\d*)\s\{(?<extras>.*)\}\)\)\)\)/,e}(w.TezosFAProtocol);e.TezosFA2Protocol=m},36943:function(t,e,n){var r=n(48287)["Buffer"],o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__awaiter||function(t,e,n,r){function o(t){return t instanceof n?t:new n(function(e){e(t)})}return new(n||(n=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r["throw"](t))}catch(e){i(e)}}function c(t){t.done?n(t.value):o(t.value).then(a,s)}c((r=r.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(o=2&i[0]?r["return"]:i[0]?r["throw"]||((o=r["return"])&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(o=a.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var s=n(48402),c=n(85858),u=n(33202),l=function(t){function e(e){void 0===e&&(e=new Uint8Array([9,245,205,134,18]));var n=t.call(this)||this;return n.edsigPrefix=e,n}return o(e,t),e.prototype.signMessage=function(t,e){return i(this,void 0,void 0,function(){var n,o,i;return a(this,function(a){switch(a.label){case 0:return[4,s.ready];case 1:return a.sent(),n=s.crypto_generichash(32,s.from_string(t)),o=s.crypto_sign_detached(n,e.privateKey),i=c.encode(r.concat([r.from(this.edsigPrefix),r.from(o)])),[2,i]}})})},e.prototype.verifyMessage=function(t,e,n){return i(this,void 0,void 0,function(){var o,i,u,l,f;return a(this,function(a){switch(a.label){case 0:return[4,s.ready];case 1:if(a.sent(),!e.startsWith("edsig"))throw new Error("invalid signature: "+e);return i=this.edsigPrefix.length,u=c.decode(e),o=new Uint8Array(u.slice(i,u.length)),l=s.crypto_generichash(32,s.from_string(t)),f=s.crypto_sign_verify_detached(o,l,r.from(n,"hex")),[2,f]}})})},e}(u.CryptoClient);e.TezosCryptoClient=l},37565:function(t,e,n){var r=n(48287)["Buffer"],o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},i.apply(this,arguments)},a=this&&this.__awaiter||function(t,e,n,r){function o(t){return t instanceof n?t:new n(function(e){e(t)})}return new(n||(n=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r["throw"](t))}catch(e){i(e)}}function c(t){t.done?n(t.value):o(t.value).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(o=2&i[0]?r["return"]:i[0]?r["throw"]||((o=r["return"])&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(o=a.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var c,u=n(95568),l=n(48402),f=n(98449),p=n(21455),d=n(66029),h=n(85858),v=n(4988),y=n(92476),g=n(26236),w=n(59159),b=n(86059),m=n(96152),T=n(28129),_=n(97992),A=n(60607),k=n(86083),P=n(43782),E=n(36943),O=n(48866),x=200,C="1040000",N="60000",D=100,z=.1,M=1;(function(t){t["DELEGATE"]="delegate",t["UNDELEGATE"]="undelegate",t["CHANGE_BAKER"]="change_baker"})(c=e.TezosDelegatorAction||(e.TezosDelegatorAction={}));var F,S=.0825;(function(t){t["MAINNET"]="mainnet",t["DELPHINET"]="delphinet"})(F=e.TezosNetwork||(e.TezosNetwork={}));var I=function(t){function e(e){void 0===e&&(e=new k.TezosProtocolOptions);var n=t.call(this)||this;return n.options=e,n.symbol="XTZ",n.name="Tezos",n.marketSymbol="xtz",n.feeSymbol="xtz",n.decimals=6,n.feeDecimals=6,n.identifier=w.MainProtocolSymbols.XTZ,n.feeDefaults={low:"0.001420",medium:"0.001520",high:"0.003000"},n.units=[{unitSymbol:"XTZ",factor:"1"}],n.supportsHD=!1,n.standardDerivationPath="m/44h/1729h/0h/0h",n.addressIsCaseSensitive=!0,n.addressValidationPattern="^(tz1|tz2|tz3|KT1)[1-9A-Za-z]{33}$",n.addressPlaceholder="tz1...",n.minCycleDuration=24576e4,n.transactionFee=new p.default("1400"),n.originationSize=new p.default("257"),n.storageCostPerByte=new p.default("1000"),n.revealFee=new p.default("1300"),n.activationBurn=n.originationSize.times(n.storageCostPerByte),n.originationBurn=n.originationSize.times(n.storageCostPerByte),n.tezosPrefixes={tz1:r.from(new Uint8Array([6,161,159])),tz2:r.from(new Uint8Array([6,161,161])),tz3:r.from(new Uint8Array([6,161,164])),kt:r.from(new Uint8Array([2,90,121])),edpk:r.from(new Uint8Array([13,15,37,217])),edsk:r.from(new Uint8Array([43,246,78,7])),edsig:r.from(new Uint8Array([9,245,205,134,18])),branch:r.from(new Uint8Array([1,52]))},n.headers={"Content-Type":"application/json",apiKey:"airgap00391"},n.rewardCalculations={alpha:new A.TezosRewardsCalculationDefault(n),babylon:new T.TezosRewardsCalculation005(n),cartha:new _.TezosRewardsCalculation006(n)},n.headers.apiKey=e.network.extras.conseilApiKey,n}return o(e,t),Object.defineProperty(e.prototype,"subProtocols",{get:function(){return b.getSubProtocolsByIdentifier(this.identifier,this.options.network)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"jsonRPCAPI",{get:function(){return this.options.network.rpcUrl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseApiUrl",{get:function(){return this.options.network.extras.conseilUrl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseApiNetwork",{get:function(){return this.options.network.extras.conseilNetwork},enumerable:!0,configurable:!0}),e.prototype.getBlockExplorerLinkForAddress=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){return[2,this.options.network.blockExplorer.getAddressLink(t)]})})},e.prototype.getBlockExplorerLinkForTxId=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){return[2,this.options.network.blockExplorer.getTransactionLink(t)]})})},e.prototype.getPublicKeyFromMnemonic=function(t,e,n){return a(this,void 0,void 0,function(){var r;return s(this,function(o){return r=d.mnemonicToSeed(t,n),[2,this.getPublicKeyFromHexSecret(r,e)]})})},e.prototype.getPrivateKeyFromMnemonic=function(t,e,n){return a(this,void 0,void 0,function(){var r;return s(this,function(o){return r=d.mnemonicToSeed(t,n),[2,this.getPrivateKeyFromHexSecret(r,e)]})})},e.prototype.getPublicKeyFromHexSecret=function(t,e){return a(this,void 0,void 0,function(){var n;return s(this,function(o){return n=v.generateWalletUsingDerivationPath(r.from(t,"hex"),e).publicKey,[2,r.from(n).toString("hex")]})})},e.prototype.getPrivateKeyFromHexSecret=function(t,e){return a(this,void 0,void 0,function(){var n;return s(this,function(o){return n=v.generateWalletUsingDerivationPath(r.from(t,"hex"),e).secretKey,[2,r.from(n)]})})},e.prototype.getAddressFromPublicKey=function(t){return a(this,void 0,void 0,function(){var e,n;return s(this,function(o){switch(o.label){case 0:return[4,l.ready];case 1:return o.sent(),e=l.crypto_generichash(20,r.from(t,"hex")),n=h.encode(r.concat([this.tezosPrefixes.tz1,r.from(e)])),[2,n]}})})},e.prototype.getAddressesFromPublicKey=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(n){switch(n.label){case 0:return[4,this.getAddressFromPublicKey(t)];case 1:return e=n.sent(),[2,[e]]}})})},e.prototype.getTransactionsFromPublicKey=function(t,e,n){return a(this,void 0,void 0,function(){var r;return s(this,function(o){switch(o.label){case 0:return[4,this.getAddressesFromPublicKey(t)];case 1:return r=o.sent(),[2,this.getTransactionsFromAddresses(r,e,n)]}})})},e.prototype.getTransactionsFromAddresses=function(t,e,n){return a(this,void 0,void 0,function(){var r,o,i=this;return s(this,function(c){switch(c.label){case 0:return[4,Promise.all(t.map(function(t){var r=function(){var r={fields:["status","amount","fee","source","destination","operation_group_hash","timestamp","block_level"],predicates:[{field:"source",operation:"eq",set:[t],inverse:!1,group:"a"},{field:"destination",operation:"eq",set:[t],inverse:!1,group:"b"},{field:"kind",operation:"eq",set:["transaction"],inverse:!1,group:"a"},{field:"kind",operation:"eq",set:["transaction"],inverse:!1,group:"b"}],orderBy:[{field:"block_level",direction:"desc"}],limit:e};return n&&n.lastBlockLevel&&(r.predicates.push({field:"block_level",operation:"lt",set:[n.lastBlockLevel.toString()],inverse:!1,group:"a"}),r.predicates.push({field:"block_level",operation:"lt",set:[n.lastBlockLevel.toString()],inverse:!1,group:"b"})),r};return new Promise(function(t,e){return a(i,void 0,void 0,function(){var e;return s(this,function(n){switch(n.label){case 0:return[4,f.default.post(this.options.network.extras.conseilUrl+"/v2/data/tezos/"+this.options.network.extras.conseilNetwork+"/operations",r(),{headers:this.headers}).catch(function(){return{data:[]}})];case 1:return e=n.sent(),t(e.data),[2]}})})})}))];case 1:return r=c.sent(),r=r.reduce(function(t,e){return t.concat(e)}).map(function(e){return{amount:new p.default(e.amount),fee:new p.default(e.fee),from:[e.source],isInbound:-1!==t.indexOf(e.destination),protocolIdentifier:i.identifier,network:i.options.network,to:[e.destination],hash:e.operation_group_hash,timestamp:e.timestamp/1e3,blockHeight:e.block_level,status:"applied"===e.status?y.AirGapTransactionStatus.APPLIED:y.AirGapTransactionStatus.FAILED}}),o=r.length>0?r[r.length-1].blockHeight:0,[2,{transactions:r,cursor:{lastBlockLevel:o}}]}})})},e.prototype.signWithPrivateKey=function(t,e){return a(this,void 0,void 0,function(){var n,o,i,a,c,u;return s(this,function(s){switch(s.label){case 0:return[4,l.ready];case 1:return s.sent(),n="03",o=n+e.binaryTransaction,i=r.from(o,"hex"),a=l.crypto_generichash(32,i),c=l.crypto_sign_detached(a,t),u=r.concat([r.from(e.binaryTransaction,"hex"),r.from(c)]),[2,u.toString("hex")]}})})},e.prototype.getTransactionDetails=function(t){return a(this,void 0,void 0,function(){var e,n;return s(this,function(r){switch(r.label){case 0:return e=t.transaction.binaryTransaction,[4,this.unforgeUnsignedTezosWrappedOperation(e)];case 1:return n=r.sent(),[2,this.getAirGapTxFromWrappedOperations(n)]}})})},e.prototype.getTransactionDetailsFromSigned=function(t){return a(this,void 0,void 0,function(){var e,n;return s(this,function(r){switch(r.label){case 0:return e=t.transaction,[4,this.unforgeSignedTezosWrappedOperation(e)];case 1:return n=r.sent(),[2,this.getAirGapTxFromWrappedOperations(n)]}})})},e.prototype.getAirGapTxFromWrappedOperations=function(t){return a(this,void 0,void 0,function(){var e,n=this;return s(this,function(r){return e=function(t){},[2,Promise.all(t.contents.map(function(t){return a(n,void 0,void 0,function(){var n,r,o,a,c,u,l=this;return s(this,function(s){switch(s.label){case 0:switch(r=[],o=t.kind,o){case P.TezosOperationType.REVEAL:return[3,1];case P.TezosOperationType.TRANSACTION:return[3,2];case P.TezosOperationType.ORIGINATION:return[3,4];case P.TezosOperationType.DELEGATION:return[3,5];case P.TezosOperationType.ENDORSEMENT:return[3,6];case P.TezosOperationType.SEED_NONCE_REVELATION:return[3,6];case P.TezosOperationType.DOUBLE_ENDORSEMENT_EVIDENCE:return[3,6];case P.TezosOperationType.DOUBLE_BAKING_EVIDENCE:return[3,6];case P.TezosOperationType.ACTIVATE_ACCOUNT:return[3,6];case P.TezosOperationType.PROPOSALS:return[3,6];case P.TezosOperationType.BALLOT:return[3,6]}return[3,7];case 1:return n=t,r=[{from:[n.source],to:["Reveal"]}],[3,8];case 2:return a=t,n=a,[4,this.getTransactionOperationDetails(a)];case 3:return r=s.sent(),[3,8];case 4:return c=t,n=c,u=c.delegate,r=[{from:[n.source],amount:new p.default(c.balance).toFixed(),to:[u?"Delegate: "+u:"Origination"]}],[3,8];case 5:return n=t,u=n.delegate,r=[{from:[n.source],to:[u||"Undelegate"]}],[3,8];case 6:throw new Error("operation not supported: "+t.kind);case 7:throw e(t.kind),new Error("no operation to unforge found");case 8:return[2,r.map(function(e){return i({amount:"0",fee:void 0!==n?new p.default(n.fee).toString(10):"0",from:[],isInbound:!1,protocolIdentifier:l.identifier,network:l.options.network,to:[],transactionDetails:t},e)})]}})})})).then(function(t){return t.reduce(function(t,e){return t.concat(e)},[])})]})})},e.prototype.getBalanceOfAddresses=function(t){return a(this,void 0,void 0,function(){var e,n,r,o,i,a;return s(this,function(s){switch(s.label){case 0:e=new p.default(0),n=0,r=t,s.label=1;case 1:if(!(n<r.length))return[3,6];o=r[n],s.label=2;case 2:return s.trys.push([2,4,,5]),[4,f.default.get(this.options.network.rpcUrl+"/chains/main/blocks/head/context/contracts/"+o+"/balance")];case 3:return i=s.sent().data,e=e.plus(new p.default(i)),[3,5];case 4:if(a=s.sent(),a.response&&404!==a.response.status)throw a;return[3,5];case 5:return n++,[3,1];case 6:return[2,e.toString(10)]}})})},e.prototype.getBalanceOfPublicKey=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(n){switch(n.label){case 0:return[4,this.getAddressFromPublicKey(t)];case 1:return e=n.sent(),[2,this.getBalanceOfAddresses([e])]}})})},e.prototype.getBalanceOfPublicKeyForSubProtocols=function(t,e){return a(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,Promise.all(e.map(function(e){return e.getBalanceOfPublicKey(t).catch(function(){return"0"})}))];case 1:return[2,n.sent()]}})})},e.prototype.getAvailableBalanceOfAddresses=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){return[2,this.getBalanceOfAddresses(t)]})})},e.prototype.estimateMaxTransactionValueFromPublicKey=function(t,e,n){return a(this,void 0,void 0,function(){var r,o,i,a,c;return s(this,function(s){switch(s.label){case 0:return[4,this.getBalanceOfPublicKey(t)];case 1:return r=s.sent(),o=new p.default(r).minus(1),void 0===n?[3,2]:(i=new p.default(n),[3,4]);case 2:return[4,this.estimateFeeDefaultsFromPublicKey(t,e,[o.toFixed()])];case 3:a=s.sent(),i=new p.default(a.medium).shiftedBy(this.decimals),i.gte(o)&&(i=new p.default(0)),s.label=4;case 4:return c=o.minus(i),c.isNegative()&&(c=new p.default(0)),[2,c.toFixed()]}})})},e.prototype.estimateFeeDefaultsFromPublicKey=function(t,e,n,r){return a(this,void 0,void 0,function(){var r,o,i,a,c;return s(this,function(s){if(e.length!==n.length)throw new Error("length of recipients and values does not match!");for(r=[],o=0;o<n.length;++o)i=n[o],a=e[o],c={kind:P.TezosOperationType.TRANSACTION,amount:i,destination:a,fee:"0"},r.push(c);return 0===e.length?[2,this.feeDefaults]:[2,this.estimateFeeDefaultsForOperations(t,r)]})})},e.prototype.estimateFeeDefaultsForOperations=function(t,e){return a(this,void 0,void 0,function(){var n,r,o,i,a,c,u;return s(this,function(s){switch(s.label){case 0:return[4,this.prepareOperations(t,e)];case 1:return n=s.sent(),r=n.contents.some(function(t){return t.kind===P.TezosOperationType.REVEAL}),o=n.contents.reduce(function(t,e){return void 0!==e.fee?t.plus(new p.default(e["fee"])):t},new p.default(0)).minus(r?this.revealFee:0).div(r?n.contents.length-1:n.contents.length),i=new p.default(.1),a=o.minus(o.times(i).integerValue(p.default.ROUND_FLOOR)),c=o,u=c.plus(c.times(i).integerValue(p.default.ROUND_FLOOR)),[2,{low:a.shiftedBy(-this.feeDecimals).toFixed(),medium:c.shiftedBy(-this.feeDecimals).toFixed(),high:u.shiftedBy(-this.feeDecimals).toFixed()}]}})})},e.prototype.prepareTransactionFromPublicKey=function(t,e,n,r,o){return a(this,void 0,void 0,function(){var i;return s(this,function(a){switch(a.label){case 0:if(e.length!==n.length)throw new Error("length of recipients and values does not match!");if(e.length>x)throw new Error("this transaction exceeds the maximum allowed number of transactions per operation ("+x+'). Please use the "prepareTransactionsFromPublicKey" method instead.');return[4,this.prepareTransactionsFromPublicKey(t,e,n,r,o)];case 1:if(i=a.sent(),1===i.length)return[2,i[0]];throw new Error("Transaction could not be prepared. More or less than 1 operations have been generated.")}})})},e.prototype.prepareTransactionsFromPublicKey=function(t,e,n,r,o,i){return void 0===i&&(i=x),a(this,void 0,void 0,function(){var a,c,u,l,d,h,v,y,g,w,b,m,T,_,A,k,P,E,O,x,C,N,D,z,M;return s(this,function(s){switch(s.label){case 0:if(a=n.map(function(t){return new p.default(t)}),c=new p.default(r),e.length!==a.length)throw new Error("length of recipients and values does not match!");return u=new p.default(1),d=[],h=o&&o.addressIndex?o.addressIndex:0,[4,this.getAddressesFromPublicKey(t)];case 1:if(v=s.sent(),!v[h])throw new Error("no kt-address with this index exists");y=v[h],s.label=2;case 2:return s.trys.push([2,6,,7]),[4,Promise.all([f.default.get(this.options.network.rpcUrl+"/chains/main/blocks/head/context/contracts/"+y+"/counter"),f.default.get(this.options.network.rpcUrl+"/chains/main/blocks/head/hash"),f.default.get(this.options.network.rpcUrl+"/chains/main/blocks/head/context/contracts/"+y+"/manager_key")])];case 3:return g=s.sent(),u=new p.default(g[0].data).plus(1),l=g[1].data,w=g[2].data,w?[3,5]:(m=(b=d).push,[4,this.createRevealOperation(u,t,y)]);case 4:m.apply(b,[s.sent()]),u=u.plus(1),s.label=5;case 5:return[3,7];case 6:throw T=s.sent(),T;case 7:return A=p.default.bind,[4,this.getBalanceOfPublicKey(t)];case 8:return _=new(A.apply(p.default,[void 0,s.sent()])),k=[],[4,this.createTransactionOperations(d,e,a,c,y,u,_)];case 9:P=s.sent(),P=d.concat(P),E=Math.ceil(P.length/i),O=0,s.label=10;case 10:return O<E?(x=O*i,C=x+i,N=P.slice(x,C),[4,this.estimateAndReplaceLimitsAndFee({branch:l,contents:N},!1)]):[3,14];case 11:return D=s.sent(),M=(z=k).push,[4,this.forgeAndWrapOperations(D)];case 12:M.apply(z,[s.sent()]),s.label=13;case 13:return O++,[3,10];case 14:return[2,k]}})})},e.prototype.getTransactionOperationDetails=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){return[2,[{from:[t.source],amount:new p.default(t.amount).toFixed(),to:[t.destination]}]]})})},e.prototype.createTransactionOperations=function(t,e,n,r,o,i,c){return a(this,void 0,void 0,function(){var a,u,l,f,d,h;return s(this,function(s){switch(s.label){case 0:a=this.getAmountUsedByPreviousOperations(t),u=[],a.isZero()||c.isLessThan(n[0].plus(r).plus(a))&&(n[0]=n[0].minus(a)),l=0,s.label=1;case 1:return l<e.length?(d=p.default.bind,[4,this.getBalanceOfAddresses([e[l]])]):[3,4];case 2:if(f=new(d.apply(p.default,[void 0,s.sent()])),f.isZero()&&e[l].toLowerCase().startsWith("tz")){if(c.isLessThan(this.activationBurn.plus(r)))throw new Error("Insufficient balance to pay activation burn!");c.isLessThan(n[l].plus(r).plus(this.activationBurn))&&(n[l]=n[l].minus(this.activationBurn))}if(c.isEqualTo(n[l].plus(r)))n[l]=n[l].minus(1);else if(c.isLessThan(n[l].plus(r)))throw new Error("not enough balance");h={kind:P.TezosOperationType.TRANSACTION,fee:r.toFixed(),gas_limit:C,storage_limit:N,amount:n[l].toFixed(),counter:i.plus(l).toFixed(),destination:e[l],source:o},u.push(h),s.label=3;case 3:return l++,[3,1];case 4:return[2,u]}})})},e.prototype.forgeAndWrapOperations=function(t){return a(this,void 0,void 0,function(){var e,n;return s(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.forgeTezosOperation(t)];case 1:return e=r.sent(),[2,{binaryTransaction:e}];case 2:throw n=r.sent(),console.warn(n.message),new Error("Forging Tezos TX failed.");case 3:return[2]}})})},e.prototype.getDefaultDelegatee=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return[4,f.default.get(this.options.network.rpcUrl+"/chains/main/blocks/head/context/delegates?active")];case 1:return t=e.sent().data,[2,t[0]||""]}})})},e.prototype.getCurrentDelegateesForPublicKey=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(n){switch(n.label){case 0:return e=this.getCurrentDelegateesForAddress,[4,this.getAddressFromPublicKey(t)];case 1:return[2,e.apply(this,[n.sent()])]}})})},e.prototype.getCurrentDelegateesForAddress=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(n){switch(n.label){case 0:return[4,f.default.get(this.options.network.rpcUrl+"/chains/main/blocks/head/context/contracts/"+t)];case 1:return e=n.sent().data,[2,e.delegate?[e.delegate]:[]]}})})},e.prototype.getDelegateeDetails=function(t){return a(this,void 0,void 0,function(){var e,n;return s(this,function(r){switch(r.label){case 0:return[4,f.default.get(this.options.network.rpcUrl+"/chains/main/blocks/head/context/delegates/"+t+"/deactivated")];case 1:return e=r.sent(),n=!e.data,[2,{status:n?"Active":"Inactive",address:t}]}})})},e.prototype.isPublicKeyDelegating=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(n){switch(n.label){case 0:return e=this.isAddressDelegating,[4,this.getAddressFromPublicKey(t)];case 1:return[2,e.apply(this,[n.sent()])]}})})},e.prototype.isAddressDelegating=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(n){switch(n.label){case 0:return[4,f.default.get(this.options.network.rpcUrl+"/chains/main/blocks/head/context/contracts/"+t)];case 1:return e=n.sent().data,[2,!!e.delegate]}})})},e.prototype.getDelegatorDetailsFromPublicKey=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(n){switch(n.label){case 0:return e=this.getDelegatorDetailsFromAddress,[4,this.getAddressFromPublicKey(t)];case 1:return[2,e.apply(this,[n.sent()])]}})})},e.prototype.getDelegatorDetailsFromAddress=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){return[2,this.getDelegatorDetails(t)]})})},e.prototype.getDelegationDetailsFromPublicKey=function(t,e){return a(this,void 0,void 0,function(){var n;return s(this,function(r){switch(r.label){case 0:return n=this.getDelegationDetailsFromAddress,[4,this.getAddressFromPublicKey(t)];case 1:return[2,n.apply(this,[r.sent(),e])]}})})},e.prototype.getDelegationDetailsFromAddress=function(t,e){return a(this,void 0,void 0,function(){var n,r,o,i;return s(this,function(a){switch(a.label){case 0:return e.length>1?[2,Promise.reject("Multiple delegation is not supported.")]:(n=e[0],[4,Promise.all([this.getDelegatorDetails(t,n),this.getDelegateeDetails(n)])]);case 1:return r=a.sent(),o=r[0],i=r[1],[2,{delegator:o,delegatees:[i]}]}})})},e.prototype.getDelegatorDetails=function(t,e){return a(this,void 0,void 0,function(){var n,r,o,i,a,u,l;return s(this,function(s){switch(s.label){case 0:return[4,Promise.all([f.default.get(this.options.network.rpcUrl+"/chains/main/blocks/head/context/contracts/"+t),this.getDelegationRewardsForAddress(t).catch(function(){return[]})])];case 1:return n=s.sent(),r=n[0].data,o=n[1],i=r.balance,a=!!r.delegate,u=[],a?e&&r.delegate!==e?u.push({type:c.CHANGE_BAKER,args:["delegate"]}):u.push({type:c.UNDELEGATE}):u.push({type:c.DELEGATE,args:["delegate"]}),l=a?o.map(function(t){return{index:t.cycle,amount:t.reward.toFixed(),collected:t.payout<new Date,timestamp:t.payout.getTime()}}):[],[2,{address:t,balance:i,delegatees:[r.delegate],availableActions:u,rewards:l}]}})})},e.prototype.prepareDelegatorActionFromPublicKey=function(t,e,n){return a(this,void 0,void 0,function(){var r;return s(this,function(o){switch(o.label){case 0:switch(r=e,r){case c.DELEGATE:return[3,1];case c.CHANGE_BAKER:return[3,1];case c.UNDELEGATE:return[3,3]}return[3,5];case 1:return n&&n.delegate?[4,this.delegate(t,n.delegate)]:[2,Promise.reject("Invalid arguments passed for "+e+" action, delegate is missing.")];case 2:return[2,[o.sent()]];case 3:return[4,this.undelegate(t)];case 4:return[2,[o.sent()]];case 5:return[2,Promise.reject("Unsupported delegator action.")]}})})},e.prototype.prepareOperations=function(t,e,n){return void 0===n&&(n=!0),a(this,void 0,void 0,function(){var r,o,i,c,u,l,d,h,v,y,g,w,b,m,T,_=this;return s(this,function(A){switch(A.label){case 0:return r=new p.default(1),i=[],[4,this.getAddressFromPublicKey(t)];case 1:c=A.sent(),A.label=2;case 2:return A.trys.push([2,6,,7]),[4,Promise.all([f.default.get(this.options.network.rpcUrl+"/chains/main/blocks/head/context/contracts/"+c+"/counter"),f.default.get(this.options.network.rpcUrl+"/chains/main/blocks/head/hash"),f.default.get(this.options.network.rpcUrl+"/chains/main/blocks/head/context/contracts/"+c+"/manager_key")])];case 3:return u=A.sent(),r=new p.default(u[0].data).plus(1),o=u[1].data,l=u[2].data,d=e.some(function(t){return t.kind===P.TezosOperationType.REVEAL}),l||d?[3,5]:(v=(h=i).push,[4,this.createRevealOperation(r,t,c)]);case 4:v.apply(h,[A.sent()]),r=r.plus(1),A.label=5;case 5:return[3,7];case 6:throw y=A.sent(),y;case 7:return g=e.map(function(t,e){return a(_,void 0,void 0,function(){var n,o,i,a,u,l,f,d,h,v,y,g,w,b,m,T,_,A,k,E,x,D,z,M,F,S,I,R,L,B,U;return s(this,function(s){switch(s.label){case 0:if(!t.kind)throw new Error('property "kind" was not defined');return n=t.destination,n&&n.toLowerCase().startsWith("tz")?(i=p.default.bind,[4,this.getBalanceOfAddresses([n])]):[3,2];case 1:o=new(i.apply(p.default,[void 0,s.sent()])),s.label=2;case 2:switch(a=r.plus(e).toFixed(),u=new p.default(this.feeDefaults.low).shiftedBy(this.decimals).toFixed(),l="10300",f=o&&o.isZero()&&n&&n.toLowerCase().startsWith("tz")?"300":"0",t.kind){case P.TezosOperationType.REVEAL:if(d=t,!d.public_key)throw new Error('property "public_key" was not defined');return d.source=(g=d.source,null!==g&&void 0!==g?g:c),d.counter=(w=d.counter,null!==w&&void 0!==w?w:a),d.fee=(b=d.fee,null!==b&&void 0!==b?b:u),d.gas_limit=(m=d.gas_limit,null!==m&&void 0!==m?m:l),d.storage_limit=(T=d.storage_limit,null!==T&&void 0!==T?T:f),[2,d];case P.TezosOperationType.DELEGATION:return h=t,h.source=(_=h.source,null!==_&&void 0!==_?_:c),h.counter=(A=h.counter,null!==A&&void 0!==A?A:a),h.fee=(k=h.fee,null!==k&&void 0!==k?k:u),h.gas_limit=(E=h.gas_limit,null!==E&&void 0!==E?E:l),h.storage_limit=(x=h.storage_limit,null!==x&&void 0!==x?x:f),[2,h];case P.TezosOperationType.TRANSACTION:if(v=t,!v.amount)throw new Error('property "amount" was not defined');if(!v.destination)throw new Error('property "destination" was not defined');return v.source=(D=v.source,null!==D&&void 0!==D?D:c),v.counter=(z=v.counter,null!==z&&void 0!==z?z:a),v.fee=(M=v.fee,null!==M&&void 0!==M?M:u),v.gas_limit=(F=v.gas_limit,null!==F&&void 0!==F?F:C),v.storage_limit=(S=v.storage_limit,null!==S&&void 0!==S?S:N),[2,v];case P.TezosOperationType.ORIGINATION:if(y=t,!y.balance)throw new Error('property "balance" was not defined');if(!y.script)throw new Error('property "script" was not defined');return y.source=(I=y.source,null!==I&&void 0!==I?I:c),y.counter=(R=y.counter,null!==R&&void 0!==R?R:a),y.fee=(L=y.fee,null!==L&&void 0!==L?L:u),y.gas_limit=(B=y.gas_limit,null!==B&&void 0!==B?B:C),y.storage_limit=(U=y.storage_limit,null!==U&&void 0!==U?U:N),[2,y];case P.TezosOperationType.ENDORSEMENT:case P.TezosOperationType.SEED_NONCE_REVELATION:case P.TezosOperationType.DOUBLE_ENDORSEMENT_EVIDENCE:case P.TezosOperationType.DOUBLE_BAKING_EVIDENCE:case P.TezosOperationType.ACTIVATE_ACCOUNT:case P.TezosOperationType.PROPOSALS:case P.TezosOperationType.BALLOT:return[2,t];default:throw O.assertNever(t.kind),new Error('unsupported operation type "'+t.kind+'"')}return[2]}})})}),b=(w=i.push).apply,m=[i],[4,Promise.all(g)];case 8:return b.apply(w,m.concat([A.sent()])),T={branch:o,contents:i},[2,this.estimateAndReplaceLimitsAndFee(T,n)]}})})},e.prototype.estimateAndReplaceLimitsAndFee=function(t,e){return void 0===e&&(e=!0),a(this,void 0,void 0,function(){var n,r,o,i,a,c,u,l;return s(this,function(s){switch(s.label){case 0:return n="sigUHx32f9wesZ1n2BWpixXz4AQaZggEtchaQNHYGRCoWNAXx45WGW2ua3apUUUAGMLPwAU41QoaFCzVSL61VaessLg4YbbP",[4,f.default.get(this.options.network.rpcUrl+"/chains/main/blocks/head/")];case 1:return r=s.sent().data,o={chain_id:r.chain_id,operation:{branch:t.branch,contents:t.contents,signature:n}},[4,this.forgeTezosOperation(t)];case 2:return i=s.sent(),a=0,[4,f.default.post(this.options.network.rpcUrl+"/chains/main/blocks/head/helpers/scripts/run_operation",o,{headers:{"Content-Type":"application/json"}}).catch(function(t){throw console.error("runOperationError",t.response?t.response:t),new g.ErrorWithData("Run operation error",t.response?t.response:t)})];case 3:if(c=s.sent(),t.contents.length!==c.data.contents.length)throw new Error("Run Operation did not return same number of operations. Locally we have "+t.contents.length+", but got back "+c.data.contents.length);return t.contents.forEach(function(t,e){var n=c.data.contents[e].metadata;if(n.operation_result){var r=t,o=n.operation_result,i=0,s=0;if(n.internal_operation_results&&n.internal_operation_results.forEach(function(t){var e;if(null===(e=t)||void 0===e?void 0:e.result){if(t.result.errors)throw new g.ErrorWithData("Internal operation errors",t.result.errors);i+=Number(t.result.consumed_gas),t.result.paid_storage_size_diff&&(s+=Number(t.result.paid_storage_size_diff)),t.result.originated_contracts&&(s+=257*t.result.originated_contracts.length),t.result.allocated_destination_contract&&(s+=257)}}),o.errors)throw new g.ErrorWithData("Operation errors",o.errors);i+=Number(o.consumed_gas),o.paid_storage_size_diff&&(s+=Number(o.paid_storage_size_diff)),o.originated_contracts&&(s+=257*o.originated_contracts.length),o.allocated_destination_contract&&(s+=257),r.gas_limit&&(r.gas_limit=i.toString()),r.storage_limit&&(r.storage_limit=s.toString()),a+=i}}),e&&(u=D+M*Math.ceil((i.length+128)/2)+z*a+100,l=Math.ceil(u/t.contents.length),t.contents.forEach(function(t){t.fee&&(t.fee=l.toString())})),[2,t]}})})},e.prototype.getDelegationInfo=function(t,e){return void 0===e&&(e=!0),a(this,void 0,void 0,function(){var n,r,o,i,a,c,u,l,p;return s(this,function(s){switch(s.label){case 0:return[4,f.default.get(this.options.network.rpcUrl+"/chains/main/blocks/head/context/contracts/"+t)];case 1:return n=s.sent().data,n.delegate&&e?(i=function(t){if(t.length>0){var e=t[0];return{date:new Date(e.timestamp),opLevel:e.block_level}}},a=function(e,n){return{predicates:[{field:e,operation:"eq",set:[t],inverse:!1},{field:"kind",operation:"eq",set:[n],inverse:!1}],orderBy:[{field:"block_level",direction:"desc"}]}},c=this.options.network.extras.conseilUrl+"/v2/data/tezos/"+this.options.network.extras.conseilNetwork+"/operations",[4,Promise.all([f.default.post(c,a("source","delegation"),{headers:this.headers}).catch(function(){return{data:[]}}),f.default.post(c,a("manager_pubkey","origination"),{headers:this.headers}).catch(function(){return{data:[]}})])]):[3,3];case 2:u=s.sent(),l=u[0].data.concat(u[1].data),p=i(l),p&&(o=p.date,r=p.opLevel),s.label=3;case 3:return[2,{isDelegated:!!n.delegate,value:n.delegate,delegatedDate:o,delegatedOpLevel:r}]}})})},e.prototype.bakerInfo=function(t){return a(this,void 0,void 0,function(){var e,n,r,o,i,a,c;return s(this,function(s){switch(s.label){case 0:if(!t||!(t.toLowerCase().startsWith("tz1")||t.toLowerCase().startsWith("tz2")||t.toLowerCase().startsWith("tz3")))throw new Error("non tz-address supplied");return[4,Promise.all([f.default.get(this.options.network.rpcUrl+"/chains/main/blocks/head/context/delegates/"+t+"/balance"),f.default.get(this.options.network.rpcUrl+"/chains/main/blocks/head/context/delegates/"+t+"/delegated_balance"),f.default.get(this.options.network.rpcUrl+"/chains/main/blocks/head/context/delegates/"+t+"/staking_balance")])];case 1:return e=s.sent(),n=new p.default(e[0].data),r=new p.default(e[1].data),o=new p.default(e[2].data),i=o.minus(r),a=o.div(i.div(S)),c={balance:n,delegatedBalance:r,stakingBalance:o,selfBond:i,bakerCapacity:o.div(a),bakerUsage:a},[2,c]}})})},e.prototype.getDelegationRewardsForAddress=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(n){switch(n.label){case 0:return[4,this.getDelegationInfo(t)];case 1:if(e=n.sent(),!e.isDelegated||!e.value)throw new Error("address not delegated");return[2,this.getDelegationRewards(e.value,t)]}})})},e.prototype.getDelegationRewards=function(t,n){return a(this,void 0,void 0,function(){var r,o,i,c,u,l,d,h=this;return s(this,function(v){switch(v.label){case 0:return[4,f.default.get(this.options.network.rpcUrl+"/chains/main/blocks/head/context/delegates/"+t+"/frozen_balance_by_cycle")];case 1:return r=v.sent().data,o=r[0].cycle-1,i=r[r.length-1].cycle,[4,f.default.get(this.options.network.rpcUrl+"/chains/main/blocks/"+i*e.BLOCKS_PER_CYCLE[this.options.network.extras.network])];case 2:return c=v.sent().data,u=new Date(c.header.timestamp),l=null!==n&&void 0!==n?n:t,[4,Promise.all(r.slice(0,5).map(function(n){return a(h,void 0,void 0,function(){var r,a,c,f;return s(this,function(s){switch(s.label){case 0:return[4,this.calculateRewards(t,n.cycle,i,!1)];case 1:return r=s.sent(),a="0",c="0",r.delegatedContracts.includes(l)?[4,this.calculatePayout(l,r)]:[3,3];case 2:f=s.sent(),a=f.balance,c=f.payout,s.label=3;case 3:return[2,{cycle:n.cycle,totalRewards:new p.default(n.rewards),totalFees:new p.default(n.fees),deposit:new p.default(n.deposit),delegatedBalance:new p.default(a),stakingBalance:new p.default(r.stakingBalance),reward:new p.default(c),payout:new Date(u.getTime()+(n.cycle-o)*e.BLOCKS_PER_CYCLE[this.options.network.extras.network]*60*1e3)}]}})})}))];case 3:return d=v.sent(),[2,d]}})})},e.prototype.undelegate=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){return[2,this.delegate(t)]})})},e.prototype.delegate=function(t,e){return a(this,void 0,void 0,function(){var n,r,o,i,a,c,u,l,d,h,v,y,g,w,b,m;return s(this,function(s){switch(s.label){case 0:return n=new p.default(1),o=[],[4,this.getAddressFromPublicKey(t)];case 1:i=s.sent(),s.label=2;case 2:return s.trys.push([2,6,,7]),[4,Promise.all([f.default.get(this.options.network.rpcUrl+"/chains/main/blocks/head/context/contracts/"+i+"/counter"),f.default.get(this.options.network.rpcUrl+"/chains/main/blocks/head/hash"),f.default.get(this.options.network.rpcUrl+"/chains/main/blocks/head/context/contracts/"+i+"/manager_key")])];case 3:return a=s.sent(),n=new p.default(a[0].data).plus(1),r=a[1].data,c=a[2].data,c?[3,5]:(l=(u=o).push,[4,this.createRevealOperation(n,t,i)]);case 4:l.apply(u,[s.sent()]),n=n.plus(1),s.label=5;case 5:return[3,7];case 6:throw d=s.sent(),d;case 7:return v=p.default.bind,[4,this.getBalanceOfAddresses([i])];case 8:if(h=new(v.apply(p.default,[void 0,s.sent()])),y=new p.default(1420),h.isLessThan(y))throw new Error("not enough balance");g={kind:P.TezosOperationType.DELEGATION,source:i,fee:y.toFixed(),counter:n.toFixed(),gas_limit:"10000",storage_limit:"0",delegate:Array.isArray(e)?e[0]:e},o.push(g),s.label=9;case 9:return s.trys.push([9,11,,12]),w={branch:r,contents:o},[4,this.forgeTezosOperation(w)];case 10:return b=s.sent(),[2,{binaryTransaction:b}];case 11:throw m=s.sent(),console.warn(m),new Error("Forging Tezos TX failed.");case 12:return[2]}})})},e.prototype.getAmountUsedByPreviousOperations=function(t){var e=new p.default(0);return t.forEach(function(t){switch(t.kind){case P.TezosOperationType.REVEAL:var n=t;e=e.plus(n.fee);break;case P.TezosOperationType.ORIGINATION:var r=t;e=e.plus(r.fee),e=e.plus(r.balance);break;case P.TezosOperationType.DELEGATION:var o=t;e=e.plus(o.fee);break;case P.TezosOperationType.TRANSACTION:var i=t;e=e.plus(i.fee),e=e.plus(i.amount);break;case P.TezosOperationType.ENDORSEMENT:case P.TezosOperationType.SEED_NONCE_REVELATION:case P.TezosOperationType.DOUBLE_ENDORSEMENT_EVIDENCE:case P.TezosOperationType.DOUBLE_BAKING_EVIDENCE:case P.TezosOperationType.ACTIVATE_ACCOUNT:case P.TezosOperationType.PROPOSALS:case P.TezosOperationType.BALLOT:break;default:throw O.assertNever(t.kind),Error("operation type not supported"+t.kind)}}),e},e.prototype.broadcastTransaction=function(t){return a(this,void 0,void 0,function(){var e,n,r,o;return s(this,function(i){switch(i.label){case 0:e=t,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,f.default.post(this.options.network.rpcUrl+"/injection/operation?chain=main",JSON.stringify(e),{headers:{"content-type":"application/json"}})];case 2:return n=i.sent().data,[2,n];case 3:throw r=i.sent(),o=r,void 0!==o.response&&void 0!==o.response.data?new Error("broadcasting failed "+o.response.data):new Error("broadcasting failed "+r);case 4:return[2]}})})},e.prototype.checkAndRemovePrefixToHex=function(t,e){var n=r.from(e).toString("hex"),o=h.decode(t).toString("hex");if(o.startsWith(n))return o.substring(2*e.length);throw new Error("payload did not match prefix: "+n)},e.prototype.unforgeSignedTezosWrappedOperation=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){if(t.length<=128)throw new Error("Not a valid signed transaction");return[2,this.unforgeUnsignedTezosWrappedOperation(t.substring(0,t.length-128))]})})},e.prototype.unforgeUnsignedTezosWrappedOperation=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){return[2,u.localForger.parse(t)]})})},e.prototype.forgeTezosOperation=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){return[2,u.localForger.forge(t)]})})},e.prototype.createRevealOperation=function(t,e,n,o){return void 0===o&&(o=this.revealFee.toFixed()),a(this,void 0,void 0,function(){var i;return s(this,function(a){return i={kind:P.TezosOperationType.REVEAL,fee:o,gas_limit:"10000",storage_limit:"0",counter:t.toFixed(),public_key:h.encode(r.concat([this.tezosPrefixes.edpk,r.from(e,"hex")])),source:n},[2,i]})})},e.prototype.getTezosVotingInfo=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(n){switch(n.label){case 0:return[4,f.default.get(this.options.network.rpcUrl+"/chains/main/blocks/"+t+"/votes/listings")];case 1:return e=n.sent(),[2,e.data]}})})},e.prototype.fetchCurrentCycle=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(n){switch(n.label){case 0:return[4,this.fetchBlockMetadata("head")];case 1:return t=n.sent(),e=t.level.cycle,[2,e]}})})},e.prototype.calculateRewards=function(t,n,r,o){return void 0===o&&(o=!0),a(this,void 0,void 0,function(){var i,a,c;return s(this,function(s){return i=this.options.network.extras.network===F.MAINNET&&n>=e.FIRST_005_CYCLE,a=this.options.network.extras.network!==F.MAINNET||n>=e.FIRST_006_CYCLE,c=a?this.rewardCalculations.cartha:i?this.rewardCalculations.babylon:this.rewardCalculations.alpha,[2,c.calculateRewards(t,n,o,r)]})})},e.prototype.calculatePayouts=function(t,e,n){return a(this,void 0,void 0,function(){var r;return s(this,function(o){if("number"===typeof e){if(void 0===n)throw new Error("limit parameter is required when providing offset");r=t.delegatedContracts.slice(e,Math.min(e+n,t.delegatedContracts.length))}else r=e;return[2,this.calculatePayoutForAddresses(r,t)]})})},e.prototype.calculatePayout=function(t,e){return a(this,void 0,void 0,function(){var n;return s(this,function(r){switch(r.label){case 0:return[4,this.calculatePayoutForAddresses([t],e)];case 1:return n=r.sent().pop(),void 0===n?[2,{delegator:t,share:"0",payout:"0",balance:"0"}]:[2,n]}})})},e.prototype.calculatePayoutForAddresses=function(t,e){return a(this,void 0,void 0,function(){var n,r,o,i,a,c,u,l,f;return s(this,function(s){switch(s.label){case 0:return n=[],r=new p.default(e.totalRewards).plus(new p.default(e.fees)),[4,this.fetchBalances(t,e.snapshotBlockLevel)];case 1:for(o=s.sent(),i=0,a=o;i<a.length;i++)c=a[i],u=c.balance,void 0===u&&(u=new p.default(0)),l=u.div(e.stakingBalance),f=r.multipliedBy(l),n.push({delegator:c.address,share:l.toFixed(),payout:f.toFixed(),balance:u.toFixed()});return[2,n]}})})},e.prototype.fetchBlockMetadata=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(n){switch(n.label){case 0:return[4,f.default.get(this.options.network.rpcUrl+"/chains/main/blocks/"+t+"/metadata")];case 1:return e=n.sent(),[2,e.data]}})})},e.prototype.fetchBalances=function(t,e){return a(this,void 0,void 0,function(){var n,r;return s(this,function(o){switch(o.label){case 0:return n={fields:["account_id","balance"],predicates:[{field:"account_id",operation:"in",set:t}],snapshot:{field:"block_level",value:e}},[4,f.default.post(this.options.network.extras.conseilUrl+"/v2/data/tezos/"+this.options.network.extras.conseilNetwork+"/accounts_history",n,{headers:this.headers})];case 1:return r=o.sent(),[2,r.data.map(function(t){return{address:t.account_id,balance:new p.default(t.balance)}})]}})})},e.prototype.signMessage=function(t,e){return a(this,void 0,void 0,function(){return s(this,function(n){return[2,new E.TezosCryptoClient(this.tezosPrefixes.edsig).signMessage(t,e)]})})},e.prototype.verifyMessage=function(t,e,n){return a(this,void 0,void 0,function(){return s(this,function(r){return[2,new E.TezosCryptoClient(this.tezosPrefixes.edsig).verifyMessage(t,e,n)]})})},e.prototype.getTransactionStatuses=function(t){return a(this,void 0,void 0,function(){var e,n,r;return s(this,function(o){switch(o.label){case 0:return e={fields:["status","operation_group_hash"],predicates:[{field:"operation_group_hash",operation:"in",set:t},{field:"kind",operation:"eq",set:["transaction"]}]},[4,f.default.post(this.options.network.extras.conseilUrl+"/v2/data/tezos/"+this.options.network.extras.conseilNetwork+"/operations",e,{headers:this.headers})];case 1:return n=o.sent(),r={},n.data.forEach(function(t){var e="applied"===t.status?y.AirGapTransactionStatus.APPLIED:y.AirGapTransactionStatus.FAILED;r[t.operation_group_hash]!==y.AirGapTransactionStatus.FAILED&&(r[t.operation_group_hash]===y.AirGapTransactionStatus.APPLIED?e===y.AirGapTransactionStatus.FAILED&&(r[t.operation_group_hash]=e):r[t.operation_group_hash]=e)}),[2,t.map(function(t){return r[t]})]}})})},e.FIRST_005_CYCLE=160,e.FIRST_006_CYCLE=208,e.BLOCKS_PER_CYCLE={mainnet:4096,delphinet:2048,edonet:2048},e}(m.NonExtendedProtocol);e.TezosProtocol=I},46172:function(t,e,n){var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(t,e,n,r){function o(t){return t instanceof n?t:new n(function(e){e(t)})}return new(n||(n=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r["throw"](t))}catch(e){i(e)}}function c(t){t.done?n(t.value):o(t.value).then(a,s)}c((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(o=2&i[0]?r["return"]:i[0]?r["throw"]||((o=r["return"])&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(o=a.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(98449),s=n(21455),c=n(59159),u=n(52916),l=n(37565),f=n(43782),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.identifier=c.SubProtocolSymbols.XTZ_KT,e.isSubProtocol=!0,e.subProtocolType=u.SubProtocolType.ACCOUNT,e.addressValidationPattern="^(tz1|KT1)[1-9A-Za-z]{33}$",e.migrationFee=new s.default(5e3),e}return r(e,t),e.prototype.getAddressFromPublicKey=function(t){return o(this,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return[4,this.getAddressesFromPublicKey(t)];case 1:return[2,e.sent()[0]]}})})},e.prototype.getAddressesFromPublicKey=function(e){return o(this,void 0,void 0,function(){var n,r,o,s;return i(this,function(i){switch(i.label){case 0:return[4,t.prototype.getAddressFromPublicKey.call(this,e)];case 1:return n=i.sent(),r=function(t,e){return{fields:["originated_contracts"],predicates:[{field:t,operation:"eq",set:[n],inverse:!1},{field:"kind",operation:"eq",set:[e],inverse:!1},{field:"status",operation:"eq",set:["applied"],inverse:!1}]}},[4,a.default.post(this.baseApiUrl+"/v2/data/tezos/mainnet/operations",r("manager_pubkey","origination"),{headers:this.headers})];case 2:return o=i.sent().data,s=o.map(function(t){return t.originated_contracts}),[2,s.reverse()]}})})},e.prototype.estimateMaxTransactionValueFromPublicKey=function(t,e,n){return o(this,void 0,void 0,function(){return i(this,function(e){return[2,this.getBalanceOfPublicKey(t)]})})},e.prototype.estimateFeeDefaultsFromPublicKey=function(t,e,n,r){return o(this,void 0,void 0,function(){var t;return i(this,function(e){return t=this.migrationFee.shiftedBy(-this.feeDecimals).toFixed(),[2,{low:t,medium:t,high:t}]})})},e.prototype.prepareTransactionFromPublicKey=function(t,e,n,r,a){return o(this,void 0,void 0,function(){return i(this,function(t){throw new Error("sending funds from KT addresses is not supported. Please use the migration feature.")})})},e.prototype.originate=function(t,e,n){return o(this,void 0,void 0,function(){return i(this,function(t){throw new Error("Originate operation not supported for KT Addresses")})})},e.prototype.delegate=function(t,e){return o(this,void 0,void 0,function(){return i(this,function(t){throw new Error("Delegate operation not supported for KT Addresses")})})},e.prototype.migrateKtContract=function(e,n){return o(this,void 0,void 0,function(){var r,o,c,u,l,p,d,h,v,y,g,w,b,m,T,_,A,k;return i(this,function(i){switch(i.label){case 0:return r=new s.default(1),c=[],[4,t.prototype.getAddressFromPublicKey.call(this,e)];case 1:return u=i.sent(),p=s.default.bind,[4,t.prototype.getBalanceOfAddresses.call(this,[u])];case 2:if(l=new(p.apply(s.default,[void 0,i.sent()])),l.isLessThan(this.migrationFee))throw new Error("not enough balance on tz address for fee");return h=s.default.bind,[4,this.getBalanceOfAddresses([n])];case 3:d=new(h.apply(s.default,[void 0,i.sent()])),i.label=4;case 4:return i.trys.push([4,8,,9]),[4,Promise.all([a.default.get(this.jsonRPCAPI+"/chains/main/blocks/head/context/contracts/"+u+"/counter"),a.default.get(this.jsonRPCAPI+"/chains/main/blocks/head/hash"),a.default.get(this.jsonRPCAPI+"/chains/main/blocks/head/context/contracts/"+u+"/manager_key")])];case 5:return v=i.sent(),r=new s.default(v[0].data).plus(1),o=v[1].data,y=v[2].data,y?[3,7]:(w=(g=c).push,[4,this.createRevealOperation(r,e,u)]);case 6:w.apply(g,[i.sent()]),r=r.plus(1),i.label=7;case 7:return[3,9];case 8:throw b=i.sent(),b;case 9:if(m=this.checkAndRemovePrefixToHex(u,this.tezosPrefixes.tz1),m.length>42)throw new Error("provided source is invalid");while(42!==m.length)m="0"+m;T={kind:f.TezosOperationType.TRANSACTION,fee:this.migrationFee.toFixed(),gas_limit:"26283",storage_limit:"0",amount:"0",counter:r.toFixed(),destination:n,source:u,parameters:{entrypoint:"do",value:[{prim:"DROP"},{prim:"NIL",args:[{prim:"operation"}]},{prim:"PUSH",args:[{prim:"key_hash"},{bytes:m}]},{prim:"IMPLICIT_ACCOUNT"},{prim:"PUSH",args:[{prim:"mutez"},{int:d.toString(10)}]},{prim:"UNIT"},{prim:"TRANSFER_TOKENS"},{prim:"CONS"}]}},c.push(T),i.label=10;case 10:return i.trys.push([10,12,,13]),_={branch:o,contents:c},[4,this.forgeTezosOperation(_)];case 11:return A=i.sent(),[2,{binaryTransaction:A}];case 12:throw k=i.sent(),console.warn(k.message),new Error("Forging Tezos TX failed.");case 13:return[2]}})})},e}(l.TezosProtocol);e.TezosKtProtocol=p},62644:function(t,e,n){var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(44388),i=n(59159),a=n(86083),s=function(t){function e(e,n,r,o,i,a,s){var c=t.call(this)||this;return c.symbol=e,c.name=n,c.marketSymbol=r,c.identifier=o,c.contractAddress=i,c.feeDefaults=a,c.decimals=s,c}return r(e,t),e}(a.TezosProtocolConfig);e.TezosFAProtocolConfig=s;var c=function(t){function e(e,n,r,o,i,a,s,c,u,l,f){var p=t.call(this,e,n,r,o,i,a,s)||this;return p.symbol=e,p.name=n,p.marketSymbol=r,p.identifier=o,p.contractAddress=i,p.feeDefaults=a,p.decimals=s,p.tokenID=c,p.tokenMetadataBigMapID=u,p.tokenMetadataBigMapName=l,p.tokenMetadataBigMapRegex=f,p}return r(e,t),e}(s);e.TezosFA2ProtocolConfig=c;var u=function(t){function e(e,n,r,a,s,c,u){return void 0===e&&(e="tzBTC"),void 0===n&&(n="Tezos BTC"),void 0===r&&(r="btc"),void 0===a&&(a=i.SubProtocolSymbols.XTZ_BTC),void 0===s&&(s=o.TezosBTCDetails.CONTRACT_ADDRESS),void 0===c&&(c={low:"0.100",medium:"0.200",high:"0.300"}),void 0===u&&(u=8),t.call(this,e,n,r,a,s,c,u)||this}return r(e,t),e}(s);e.TezosBTCProtocolConfig=u;var l=function(t){function e(e,n,r,o,a,s,c){return void 0===e&&(e="STKR"),void 0===n&&(n="Staker"),void 0===r&&(r="stkr"),void 0===o&&(o=i.SubProtocolSymbols.XTZ_BTC),void 0===a&&(a="KT1EctCuorV2NfVb1XTQgvzJ88MQtWP8cMMv"),void 0===s&&(s={low:"0.100",medium:"0.300",high:"0.500"}),void 0===c&&(c=6),t.call(this,e,n,r,o,a,s,c)||this}return r(e,t),e}(s);e.TezosStakerProtocolConfig=l;var f=function(t){function e(e,n,r,o,a,s,c){return void 0===e&&(e="USDtz"),void 0===n&&(n="USD Tez"),void 0===r&&(r="USDtz"),void 0===o&&(o=i.SubProtocolSymbols.XTZ_USD),void 0===a&&(a="KT1LN4LPSqTMS7Sd2CJw4bbDGRkMv2t68Fy9"),void 0===s&&(s={low:"0.100",medium:"0.300",high:"0.500"}),void 0===c&&(c=6),t.call(this,e,n,r,o,a,s,c)||this}return r(e,t),e}(s);e.TezosUSDProtocolConfig=f;var p=function(){function t(t,e){void 0===t&&(t=new a.TezosProtocolNetwork),this.network=t,this.config=e}return t}();e.TezosFAProtocolOptions=p;var d=function(){function t(t,e){void 0===t&&(t=new a.TezosProtocolNetwork),this.network=t,this.config=e}return t}();e.TezosFA2ProtocolOptions=d},74084:function(t,e,n){var r=this&&this.__awaiter||function(t,e,n,r){function o(t){return t instanceof n?t:new n(function(e){e(t)})}return new(n||(n=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r["throw"](t))}catch(e){i(e)}}function c(t){t.done?n(t.value):o(t.value).then(a,s)}c((r=r.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(o=2&i[0]?r["return"]:i[0]?r["throw"]||((o=r["return"])&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(o=a.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},i=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r};Object.defineProperty(e,"__esModule",{value:!0});var a=n(98449),s=n(95317),c=n(35937),u=n(32680),l=n(99055),f=n(35284),p=n(27534),d=function(){function t(t,e,n,r,o){this.address=t,this.nodeRPCURL=e,this.conseilAPIURL=n,this.conseilNetwork=r,this.conseilAPIKey=o}return t.prototype.bigMapValues=function(t){var e,n,a,s;return void 0===t&&(t={}),r(this,void 0,void 0,function(){var r,c,u;return o(this,function(o){switch(o.label){case 0:return n=null===(e=t)||void 0===e?void 0:e.bigMapID,null===n||void 0===n?[3,1]:(c=n,[3,3]);case 1:return[4,this.getBigMapID(t.bigMapFilter)];case 2:c=o.sent(),o.label=3;case 3:return r=c,u=i([{field:"big_map_id",operation:"eq",set:[r]}],(a=t.predicates,null!==a&&void 0!==a?a:[])),[2,this.apiRequest("big_map_contents",{fields:["key","key_hash","value"],predicates:u,limit:(s=t.limit,null!==s&&void 0!==s?s:1e5)})]}})})},t.prototype.createContractCall=function(t,e){var n;return r(this,void 0,void 0,function(){var r;return o(this,function(o){switch(o.label){case 0:return[4,this.waitForEntrypoints()];case 1:return o.sent(),r=null===(n=this.entrypoints)||void 0===n?void 0:n.get(t),r?[2,this.createEntrypointContractCall(r,e)]:[2,this.createDefaultContractCall(e)]}})})},t.prototype.parseContractCall=function(t){var e;return r(this,void 0,void 0,function(){var n;return o(this,function(r){switch(r.label){case 0:return[4,this.waitForEntrypoints()];case 1:return r.sent(),n=null===(e=this.entrypoints)||void 0===e?void 0:e.get(t.entrypoint),n?[2,this.createEntrypointContractCall(n,t.value,{lazyEval:!1,onNext:function(t,e,n){var r=t.getAnnotation(u.MichelsonAnnotationPrefix.FIELD,u.MichelsonAnnotationPrefix.TYPE);r&&n.setName(r)}})]:[2,Promise.reject("Couldn't parse the contract call, unknown entrypoint: "+t.entrypoint)]}})})},t.prototype.normalizeContractCallParameters=function(e,n){var i;return r(this,void 0,void 0,function(){var r,a,c,f;return o(this,function(o){switch(o.label){case 0:return r="entrypoint"in e?e.entrypoint:void 0,a="value"in e?e.value:e,void 0!==r&&r!==t.DEFAULT_ENTRYPOINT?[2,{entrypoint:r,value:a}]:s.MichelsonOr.isOr(a)?[4,this.waitForEntrypoints()]:[2,{entrypoint:null!==n&&void 0!==n?n:t.DEFAULT_ENTRYPOINT,value:a}];case 1:if(o.sent(),c=null===(i=this.entrypoints)||void 0===i?void 0:i.get(t.DEFAULT_ENTRYPOINT),!c)throw new Error("Could not fetch default entrypoint.");return c.type.createValue(a,{beforeNext:function(t,e){var n=t.getAnnotation(u.MichelsonAnnotationPrefix.FIELD);n&&l.isMichelineNode(e)&&(f=[n,e])},onNext:function(t,e,n){n instanceof s.MichelsonOr&&n.eval()}}),[2,{entrypoint:f?f[0]:null!==n&&void 0!==n?n:c.name,value:f?f[1]:a}]}})})},t.prototype.createDefaultContractCall=function(e){return new f.TezosContractCall(t.DEFAULT_ENTRYPOINT,e instanceof c.MichelsonType?e:void 0)},t.prototype.createEntrypointContractCall=function(t,e,n){return void 0===n&&(n={}),new f.TezosContractCall(t.name,t.type.createValue(e,n))},t.prototype.getBigMapID=function(t){var e;return r(this,void 0,void 0,function(){var n;return o(this,function(r){switch(r.label){case 0:return[4,this.waitForBigMapIDs()];case 1:if(r.sent(),1===(null===(e=this.bigMapIDs)||void 0===e?void 0:e.length))return[2,this.bigMapIDs[0]];if(!t)throw new Error("Contract has more that one BigMap, provide ID or predicates to select one.");return[4,this.apiRequest("big_maps",{fields:["big_map_id"],predicates:i([{field:"big_map_id",operation:"in",set:this.bigMapIDs}],t)})];case 2:if(n=r.sent(),0===n.length)throw new Error("BigMap ID not found");if(n.length>1)throw new Error("More than one BigMap ID has been found for the predicates.");return[2,n[0].big_map_id]}})})},t.prototype.waitForBigMapIDs=function(){return r(this,void 0,void 0,function(){var t=this;return o(this,function(e){return void 0!==this.bigMapIDs?[2]:(void 0===this.bigMapIDsPromise&&(this.bigMapIDsPromise=this.apiRequest("originated_account_maps",{fields:["big_map_id"],predicates:[{field:"account_id",operation:"eq",set:[this.address]}]}).then(function(e){if(0===e.length)throw new Error("BigMap IDs not found");t.bigMapIDs=e.map(function(t){return t.big_map_id})}).finally(function(){t.bigMapIDsPromise=void 0})),[2,this.bigMapIDsPromise])})})},t.prototype.waitForEntrypoints=function(){return r(this,void 0,void 0,function(){var e,n,r=this;return o(this,function(o){return void 0!==this.entrypoints?[2]:(void 0===this.entrypointsPromise&&(e=this.nodeRequest("script"),n=this.nodeRequest("entrypoints"),this.entrypointsPromise=Promise.all([e,n]).then(function(e){var n=e[0],o=e[1];if(void 0===o.entrypoints[t.DEFAULT_ENTRYPOINT]){var i=n.code.find(function(t){return"parameter"===t.prim});i&&(o.entrypoints[t.DEFAULT_ENTRYPOINT]=i.args?i.args[0]:[])}r.entrypoints=new Map(p.TezosContractEntrypoint.fromJSON(o.entrypoints).map(function(t){return[t.name,t]}))}).finally(function(){r.entrypointsPromise=void 0})),[2,this.entrypointsPromise])})})},t.prototype.nodeRequest=function(t){return r(this,void 0,void 0,function(){var e;return o(this,function(n){switch(n.label){case 0:return[4,a.default.get(this.nodeRPCURL+"/chains/main/blocks/head/context/contracts/"+this.address+"/"+t)];case 1:return e=n.sent(),[2,e.data]}})})},t.prototype.apiRequest=function(t,e){return r(this,void 0,void 0,function(){var n;return o(this,function(r){switch(r.label){case 0:return[4,a.default.post(this.conseilAPIURL+"/v2/data/tezos/"+this.conseilNetwork+"/"+t,e,{headers:{"Content-Type":"application/json",apiKey:this.conseilAPIKey}})];case 1:return n=r.sent(),[2,n.data]}})})},t.DEFAULT_ENTRYPOINT="default",t}();e.TezosContract=d},86083:function(t,e,n){var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(t,e,n,r){function o(t){return t instanceof n?t:new n(function(e){e(t)})}return new(n||(n=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r["throw"](t))}catch(e){i(e)}}function c(t){t.done?n(t.value):o(t.value).then(a,s)}c((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(o=2&i[0]?r["return"]:i[0]?r["throw"]||((o=r["return"])&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(o=a.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(66408),s=n(37565),c="Mainnet",u="https://tezos-node.prod.gke.papers.tech",l="https://tezblock.io",f="https://tezos-mainnet-conseil.prod.gke.papers.tech",p="airgap00391",d=function(){function t(t,e,n,r){void 0===t&&(t=s.TezosNetwork.MAINNET),void 0===e&&(e=f),void 0===n&&(n=s.TezosNetwork.MAINNET),void 0===r&&(r=p),this.network=t,this.conseilUrl=e,this.conseilNetwork=n,this.conseilApiKey=r}return t}();e.TezosProtocolNetworkExtras=d;var h=function(){function t(t){void 0===t&&(t=l),this.blockExplorer=t}return t.prototype.getAddressLink=function(t){return o(this,void 0,void 0,function(){return i(this,function(e){return[2,this.blockExplorer+"/account/"+t]})})},t.prototype.getTransactionLink=function(t){return o(this,void 0,void 0,function(){return i(this,function(e){return[2,this.blockExplorer+"/transaction/"+t]})})},t}();e.TezblockBlockExplorer=h;var v=function(t){function e(e,n,r,o,i){return void 0===e&&(e=c),void 0===n&&(n=a.NetworkType.MAINNET),void 0===r&&(r=u),void 0===o&&(o=new h),void 0===i&&(i=new d),t.call(this,e,n,r,o,i)||this}return r(e,t),e}(a.ProtocolNetwork);e.TezosProtocolNetwork=v;var y=function(){function t(){}return t}();e.TezosProtocolConfig=y;var g=function(){function t(t,e){void 0===t&&(t=new v),void 0===e&&(e=new y),this.network=t,this.config=e}return t}();e.TezosProtocolOptions=g},88965:function(t,e,n){var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(t,e,n,r){function o(t){return t instanceof n?t:new n(function(e){e(t)})}return new(n||(n=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r["throw"](t))}catch(e){i(e)}}function c(t){t.done?n(t.value):o(t.value).then(a,s)}c((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(o=2&i[0]?r["return"]:i[0]?r["throw"]||((o=r["return"])&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(o=a.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(86083),s=n(6220),c=n(91219),u=n(62644),l=function(t){function e(e){void 0===e&&(e=new u.TezosFAProtocolOptions(new a.TezosProtocolNetwork,new u.TezosUSDProtocolConfig));var n=t.call(this,e)||this;return n.options=e,n}return r(e,t),e.prototype.fetchTokenHolders=function(){return o(this,void 0,void 0,function(){var t;return i(this,function(n){switch(n.label){case 0:return[4,this.contract.bigMapValues()];case 1:return t=n.sent(),[2,t.map(function(t){try{var r=s.TezosUtils.parseAddress(t.key);if(void 0===r||!t.value)return{address:"",amount:"0"};var o="0",i=e.extractAmountRegex.exec(t.value);return i&&(o=i[1]),{address:r,amount:o}}catch(n){return{address:"",amount:"0"}}}).filter(function(t){return"0"!==t.amount})]}})})},e.extractAmountRegex=/Pair ([0-9]+) /,e}(c.TezosFA12Protocol);e.TezosUSD=l},91219:function(t,e,n){var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(t,e,n,r){function o(t){return t instanceof n?t:new n(function(e){e(t)})}return new(n||(n=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r["throw"](t))}catch(e){i(e)}}function c(t){t.done?n(t.value):o(t.value).then(a,s)}c((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(o=2&i[0]?r["return"]:i[0]?r["throw"]||((o=r["return"])&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(o=a.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var a,s=n(21455),c=n(21189);(function(t){t["BALANCE"]="getBalance",t["ALLOWANCE"]="getAllowance",t["APPROVE"]="approve",t["TRANSFER"]="transfer",t["TOTAL_SUPPLY"]="getTotalSupply"})(a||(a={}));var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getAllowance=function(t,e,n,r){return void 0===n&&(n=this.callbackContract()),o(this,void 0,void 0,function(){var o;return i(this,function(i){switch(i.label){case 0:return[4,this.contract.createContractCall(a.ALLOWANCE,[{owner:t,spender:e},n])];case 1:return o=i.sent(),[2,this.getContractCallIntResult(o,this.requireSource(r,e,"kt"))]}})})},e.prototype.approve=function(t,e,n,r){return o(this,void 0,void 0,function(){var o;return i(this,function(i){switch(i.label){case 0:return[4,this.contract.createContractCall(a.APPROVE,{spender:t,value:new s.default(e).toNumber()})];case 1:return o=i.sent(),[2,this.prepareContractCall([o],n,r)]}})})},e}(c.TezosFA1Protocol);e.TezosFA12Protocol=u},98086:function(t,e,n){var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(t,e,n,r){function o(t){return t instanceof n?t:new n(function(e){e(t)})}return new(n||(n=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r["throw"](t))}catch(e){i(e)}}function c(t){t.done?n(t.value):o(t.value).then(a,s)}c((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(o=2&i[0]?r["return"]:i[0]?r["throw"]||((o=r["return"])&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(o=a.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var a,s=n(21455),c=n(86083),u=n(6220),l=n(63568),f=n(40431),p=n(91219),d=n(62644);(function(t){t["TOTAL_MINTED"]="getTotalMinted",t["TOTAL_BURNED"]="getTotalBurned"})(a||(a={}));var h=function(t){function e(e){void 0===e&&(e=new d.TezosFAProtocolOptions(new c.TezosProtocolNetwork,new d.TezosBTCProtocolConfig));var n=t.call(this,e)||this;return n.options=e,n}return r(e,t),e.prototype.getTotalMinted=function(t,e){return void 0===e&&(e=this.callbackContract()),o(this,void 0,void 0,function(){var n;return i(this,function(r){switch(r.label){case 0:return[4,this.contract.createContractCall(a.TOTAL_MINTED,[[],e])];case 1:return n=r.sent(),[2,this.getContractCallIntResult(n,this.requireSource(t))]}})})},e.prototype.getTotalBurned=function(t,e){return void 0===e&&(e=this.callbackContract()),o(this,void 0,void 0,function(){var n;return i(this,function(r){switch(r.label){case 0:return[4,this.contract.createContractCall(a.TOTAL_BURNED,[[],e])];case 1:return n=r.sent(),[2,this.getContractCallIntResult(n,this.requireSource(t))]}})})},e.prototype.fetchTokenHolders=function(){return o(this,void 0,void 0,function(){var t;return i(this,function(n){switch(n.label){case 0:return[4,this.contract.bigMapValues({predicates:[{field:"key",operation:"startsWith",set:[e.bigMapKeyLedgerPrefix]}]})];case 1:return t=n.sent(),[2,t.map(function(t){var r=t.key.substring(e.bigMapKeyLedgerPrefix.length),o=u.TezosUtils.parseAddress(r),i=f.MichelsonInt.from(0);try{t.value&&(i=u.TezosUtils.parseHex(t.value))}catch(n){}i instanceof l.MichelsonPair&&(i=i.first.get());var a=i instanceof f.MichelsonInt?i.value:new s.default(0);return{address:o,amount:a.toFixed()}}).filter(function(t){return"0"!==t.amount})]}})})},e.bigMapKeyLedgerPrefix="0x05070701000000066c65646765720a00000016",e}(p.TezosFA12Protocol);e.TezosBTC=h}}]);